---
title: Some ways for plotting 3D linear models
author: Sebastian Sauer
date: '2019-10-21'
slug: some-ways-for-plotting-3d-linear-models
categories:
  - rstats
tags:
  - regression
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div id="load-packages" class="section level1">
<h1>Load packages</h1>
<pre class="r"><code>library(tidyverse)
library(mosaic)
library(plotly)
library(scatterplot3d)</code></pre>
</div>
<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>Linear models are a standard way of predicting or explaining some data. Visualizing data is not only of didactical value but provides heuristical value too, as demonstrated by <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">Anscombe’s Quartet</a>.</p>
<p>Visualizing linear models in 2D is straightforward, but visualizing linear models with more than one predictor is much less so. The aim of this post is to demonstrate some ways do visualize linear models with more than one predictor, using popular R packages. We will focus on 3D examples, that is, two predictors.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Some data</p>
<pre class="r"><code>data(mtcars)</code></pre>
<p>Some packages</p>
<pre class="r"><code>library(tidyverse)
library(mosaic)</code></pre>
</div>
<div id="baseline-model" class="section level1">
<h1>Baseline model</h1>
<p>For the sake of simplicity, let’s start with a 2D model.</p>
<pre class="r"><code>lm0 &lt;- lm(mpg ~ hp, data = mtcars)</code></pre>
<div id="mosaic" class="section level2">
<h2>`mosaic``</h2>
<pre class="r"><code>plotModel(lm0)</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="ggformula" class="section level2">
<h2>`ggformula``</h2>
<pre class="r"><code>gf_point(mpg ~ hp, data = mtcars) %&gt;% 
  gf_lm()</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="ggplot2" class="section level2">
<h2><code>ggplot2</code></h2>
<pre class="r"><code>f0 &lt;- function(x) {coef(lm0)[1] + coef(lm0)[2] * x}

ggplot(mtcars) +
  aes(x = hp, y = mpg) +
  geom_point() +
  stat_function(fun = f0)</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="makefun" class="section level2">
<h2><code>makeFun</code></h2>
<p>Extracting the function itself from a linear model can be achieved like this:</p>
<pre class="r"><code>f0 &lt;- makeFun(lm0)
f0
#&gt; function (hp, ..., transformation = function (x) 
#&gt; x) 
#&gt; return(transformation(predict(model, newdata = data.frame(hp = hp), 
#&gt;     ...)))
#&gt; &lt;environment: 0x7feb7b4f3200&gt;
#&gt; attr(,&quot;coefficients&quot;)
#&gt; (Intercept)          hp 
#&gt; 30.09886054 -0.06822828</code></pre>
<p>Then again:</p>
<pre class="r"><code>ggplot(mtcars) +
  aes(x = hp, y = mpg) +
  geom_point() +
  stat_function(fun = f0)</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="our-initial-linear-model-for-3d" class="section level1">
<h1>Our (initial) linear model for 3D</h1>
<pre class="r"><code>lm1 &lt;- lm(mpg ~ hp * disp, data = mtcars)</code></pre>
<div id="gf_function_2d" class="section level2">
<h2><code>gf_function_2d()</code></h2>
<p>Let’s briefly check the range of the predictors:</p>
<pre class="r"><code>preds &lt;- c(&quot;hp&quot;, &quot;disp&quot;)</code></pre>
<pre class="r"><code>mtcars %&gt;% 
  dplyr::select(one_of(preds)) %&gt;% 
  summarise_all(funs(min, max))
#&gt;   hp_min disp_min hp_max disp_max
#&gt; 1     52     71.1    335      472</code></pre>
<p>We’ll use this information to gauge the limits of the following graph:</p>
<pre class="r"><code>f1 &lt;- makeFun(lm1)

p1 &lt;- gf_function_2d(f1, xlim = c(50, 300), ylim = c(50, 500)) %&gt;% 
  gf_labs(x = &quot;hp&quot;, y = &quot;disp&quot;) %&gt;% 
  gf_refine(scale_fill_viridis_c())
p1</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="computing-a-grid-and-plotting-it" class="section level2">
<h2>Computing a grid and plotting it</h2>
<p>First we devise seom combinations of hp and disp values. Then we predict the <code>mpg</code> values based on those values using <code>lm1</code>.</p>
<pre class="r"><code>hp_disp_grid &lt;- expand_grid(hp = seq(50, 300, by = 10), disp = seq(50, 500, by= 10))


grid2 &lt;- hp_disp_grid %&gt;% 
  mutate(mpg_pred_lm1 = predict(lm1, newdata = data.frame(hp, disp)))</code></pre>
<p>Check</p>
<pre class="r"><code>gf_density(~mpg_pred_lm1, data = grid2)</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Now add the predicted value to the <code>mtcars</code> dataframe too:</p>
<pre class="r"><code>mtcars &lt;- mtcars %&gt;% 
  mutate(pred_lm1 = predict(lm1))</code></pre>
<pre class="r"><code>ggplot(aes(x = hp, y = disp), data = grid2) +
  geom_raster(aes(fill = mpg_pred_lm1)) +
  scale_fill_viridis_c() +
  geom_point(data = mtcars, aes(color = pred_lm1)) +
  scale_color_viridis_c()</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plotfun-as-tile-plot-heatmap" class="section level2">
<h2><code>plotFun</code> as tile plot (heatmap)</h2>
<p>mosaic provides a convenient function to plot linear models with predictors, <code>plotFun()</code>.</p>
<pre class="r"><code>plotFun(f1(hp, disp) ~ hp &amp; disp)</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plotfun-as-3d-surface-plot" class="section level2">
<h2><code>plotFun</code> as 3d surface plot</h2>
<pre class="r"><code>plotFun(f1(hp, disp) ~ hp &amp; disp, surface = TRUE)</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plotly-surface" class="section level2">
<h2>Plotly surface</h2>
<p>For plotly surface, we need the data in <em>wide</em> format, ie., we need to spread them out, from long (tidy, standard) format to the wide format. In addition, there should be no more name (key) column, and it ought to be a matrix:</p>
<pre class="r"><code>grid_wide &lt;- grid2 %&gt;% 
  pivot_wider(names_from = disp, values_from = mpg_pred_lm1) %&gt;% 
  select(-1) %&gt;% 
  as.matrix

grid_wide
#&gt;             50       60       70       80       90      100      110
#&gt;  [1,] 31.83602 31.24732 30.65861 30.06991 29.48120 28.89249 28.30379
#&gt;  [2,] 31.00211 30.44240 29.88270 29.32300 28.76330 28.20360 27.64390
#&gt;  [3,] 30.16819 29.63749 29.10680 28.57610 28.04540 27.51471 26.98401
#&gt;  [4,] 29.33427 28.83258 28.33089 27.82920 27.32751 26.82582 26.32413
#&gt;  [5,] 28.50035 28.02767 27.55498 27.08229 26.60961 26.13692 25.66424
#&gt;  [6,] 27.66643 27.22275 26.77907 26.33539 25.89171 25.44803 25.00435
#&gt;  [7,] 26.83252 26.41784 26.00316 25.58849 25.17381 24.75914 24.34446
#&gt;  [8,] 25.99860 25.61293 25.22726 24.84159 24.45592 24.07024 23.68457
#&gt;  [9,] 25.16468 24.80801 24.45135 24.09468 23.73802 23.38135 23.02469
#&gt; [10,] 24.33076 24.00310 23.67544 23.34778 23.02012 22.69246 22.36480
#&gt; [11,] 23.49685 23.19819 22.89953 22.60088 22.30222 22.00357 21.70491
#&gt; [12,] 22.66293 22.39328 22.12363 21.85397 21.58432 21.31467 21.04502
#&gt; [13,] 21.82901 21.58836 21.34772 21.10707 20.86643 20.62578 20.38513
#&gt; [14,] 20.99509 20.78345 20.57181 20.36017 20.14853 19.93689 19.72525
#&gt; [15,] 20.16117 19.97854 19.79590 19.61327 19.43063 19.24799 19.06536
#&gt; [16,] 19.32726 19.17363 19.01999 18.86636 18.71273 18.55910 18.40547
#&gt; [17,] 18.49334 18.36871 18.24409 18.11946 17.99483 17.87021 17.74558
#&gt; [18,] 17.65942 17.56380 17.46818 17.37256 17.27694 17.18131 17.08569
#&gt; [19,] 16.82550 16.75889 16.69227 16.62565 16.55904 16.49242 16.42580
#&gt; [20,] 15.99159 15.95397 15.91636 15.87875 15.84114 15.80353 15.76592
#&gt; [21,] 15.15767 15.14906 15.14045 15.13185 15.12324 15.11464 15.10603
#&gt; [22,] 14.32375 14.34415 14.36455 14.38495 14.40534 14.42574 14.44614
#&gt; [23,] 13.48983 13.53924 13.58864 13.63804 13.68745 13.73685 13.78625
#&gt; [24,] 12.65591 12.73432 12.81273 12.89114 12.96955 13.04796 13.12636
#&gt; [25,] 11.82200 11.92941 12.03682 12.14424 12.25165 12.35906 12.46648
#&gt; [26,] 10.98808 11.12450 11.26092 11.39733 11.53375 11.67017 11.80659
#&gt;            120      130      140      150      160      170      180
#&gt;  [1,] 27.71508 27.12638 26.53767 25.94897 25.36026 24.77156 24.18285
#&gt;  [2,] 27.08420 26.52450 25.96480 25.40510 24.84540 24.28570 23.72600
#&gt;  [3,] 26.45332 25.92262 25.39193 24.86123 24.33053 23.79984 23.26914
#&gt;  [4,] 25.82243 25.32074 24.81905 24.31736 23.81567 23.31398 22.81229
#&gt;  [5,] 25.19155 24.71887 24.24618 23.77349 23.30081 22.82812 22.35544
#&gt;  [6,] 24.56067 24.11699 23.67331 23.22963 22.78595 22.34226 21.89858
#&gt;  [7,] 23.92979 23.51511 23.10043 22.68576 22.27108 21.85641 21.44173
#&gt;  [8,] 23.29890 22.91323 22.52756 22.14189 21.75622 21.37055 20.98488
#&gt;  [9,] 22.66802 22.31135 21.95469 21.59802 21.24136 20.88469 20.52802
#&gt; [10,] 22.03714 21.70948 21.38181 21.05415 20.72649 20.39883 20.07117
#&gt; [11,] 21.40625 21.10760 20.80894 20.51028 20.21163 19.91297 19.61432
#&gt; [12,] 20.77537 20.50572 20.23607 19.96642 19.69677 19.42711 19.15746
#&gt; [13,] 20.14449 19.90384 19.66319 19.42255 19.18190 18.94126 18.70061
#&gt; [14,] 19.51360 19.30196 19.09032 18.87868 18.66704 18.45540 18.24376
#&gt; [15,] 18.88272 18.70008 18.51745 18.33481 18.15218 17.96954 17.78690
#&gt; [16,] 18.25184 18.09821 17.94458 17.79094 17.63731 17.48368 17.33005
#&gt; [17,] 17.62095 17.49633 17.37170 17.24708 17.12245 16.99782 16.87320
#&gt; [18,] 16.99007 16.89445 16.79883 16.70321 16.60759 16.51196 16.41634
#&gt; [19,] 16.35919 16.29257 16.22596 16.15934 16.09272 16.02611 15.95949
#&gt; [20,] 15.72831 15.69069 15.65308 15.61547 15.57786 15.54025 15.50264
#&gt; [21,] 15.09742 15.08882 15.08021 15.07160 15.06300 15.05439 15.04578
#&gt; [22,] 14.46654 14.48694 14.50734 14.52773 14.54813 14.56853 14.58893
#&gt; [23,] 13.83566 13.88506 13.93446 13.98387 14.03327 14.08267 14.13208
#&gt; [24,] 13.20477 13.28318 13.36159 13.44000 13.51841 13.59681 13.67522
#&gt; [25,] 12.57389 12.68130 12.78872 12.89613 13.00354 13.11096 13.21837
#&gt; [26,] 11.94301 12.07943 12.21584 12.35226 12.48868 12.62510 12.76152
#&gt;            190      200      210      220      230      240      250
#&gt;  [1,] 23.59414 23.00544 22.41673 21.82803 21.23932 20.65062 20.06191
#&gt;  [2,] 23.16630 22.60660 22.04690 21.48719 20.92749 20.36779 19.80809
#&gt;  [3,] 22.73845 22.20775 21.67706 21.14636 20.61567 20.08497 19.55427
#&gt;  [4,] 22.31060 21.80891 21.30722 20.80553 20.30384 19.80215 19.30046
#&gt;  [5,] 21.88275 21.41007 20.93738 20.46469 19.99201 19.51932 19.04664
#&gt;  [6,] 21.45490 21.01122 20.56754 20.12386 19.68018 19.23650 18.79282
#&gt;  [7,] 21.02705 20.61238 20.19770 19.78303 19.36835 18.95368 18.53900
#&gt;  [8,] 20.59921 20.21354 19.82786 19.44219 19.05652 18.67085 18.28518
#&gt;  [9,] 20.17136 19.81469 19.45803 19.10136 18.74469 18.38803 18.03136
#&gt; [10,] 19.74351 19.41585 19.08819 18.76053 18.43287 18.10520 17.77754
#&gt; [11,] 19.31566 19.01700 18.71835 18.41969 18.12104 17.82238 17.52372
#&gt; [12,] 18.88781 18.61816 18.34851 18.07886 17.80921 17.53956 17.26991
#&gt; [13,] 18.45996 18.21932 17.97867 17.73803 17.49738 17.25673 17.01609
#&gt; [14,] 18.03212 17.82047 17.60883 17.39719 17.18555 16.97391 16.76227
#&gt; [15,] 17.60427 17.42163 17.23899 17.05636 16.87372 16.69109 16.50845
#&gt; [16,] 17.17642 17.02279 16.86916 16.71552 16.56189 16.40826 16.25463
#&gt; [17,] 16.74857 16.62394 16.49932 16.37469 16.25007 16.12544 16.00081
#&gt; [18,] 16.32072 16.22510 16.12948 16.03386 15.93824 15.84262 15.74699
#&gt; [19,] 15.89287 15.82626 15.75964 15.69302 15.62641 15.55979 15.49318
#&gt; [20,] 15.46503 15.42741 15.38980 15.35219 15.31458 15.27697 15.23936
#&gt; [21,] 15.03718 15.02857 15.01996 15.01136 15.00275 14.99414 14.98554
#&gt; [22,] 14.60933 14.62973 14.65013 14.67052 14.69092 14.71132 14.73172
#&gt; [23,] 14.18148 14.23088 14.28029 14.32969 14.37909 14.42850 14.47790
#&gt; [24,] 13.75363 13.83204 13.91045 13.98886 14.06726 14.14567 14.22408
#&gt; [25,] 13.32578 13.43320 13.54061 13.64802 13.75544 13.86285 13.97026
#&gt; [26,] 12.89793 13.03435 13.17077 13.30719 13.44361 13.58003 13.71644
#&gt;            260      270      280      290      300      310      320
#&gt;  [1,] 19.47321 18.88450 18.29579 17.70709 17.11838 16.52968 15.94097
#&gt;  [2,] 19.24839 18.68869 18.12899 17.56929 17.00959 16.44989 15.89019
#&gt;  [3,] 19.02358 18.49288 17.96219 17.43149 16.90080 16.37010 15.83940
#&gt;  [4,] 18.79876 18.29707 17.79538 17.29369 16.79200 16.29031 15.78862
#&gt;  [5,] 18.57395 18.10127 17.62858 17.15589 16.68321 16.21052 15.73784
#&gt;  [6,] 18.34914 17.90546 17.46178 17.01809 16.57441 16.13073 15.68705
#&gt;  [7,] 18.12432 17.70965 17.29497 16.88030 16.46562 16.05094 15.63627
#&gt;  [8,] 17.89951 17.51384 17.12817 16.74250 16.35683 15.97116 15.58548
#&gt;  [9,] 17.67470 17.31803 16.96136 16.60470 16.24803 15.89137 15.53470
#&gt; [10,] 17.44988 17.12222 16.79456 16.46690 16.13924 15.81158 15.48392
#&gt; [11,] 17.22507 16.92641 16.62776 16.32910 16.03044 15.73179 15.43313
#&gt; [12,] 17.00025 16.73060 16.46095 16.19130 15.92165 15.65200 15.38235
#&gt; [13,] 16.77544 16.53479 16.29415 16.05350 15.81286 15.57221 15.33156
#&gt; [14,] 16.55063 16.33899 16.12734 15.91570 15.70406 15.49242 15.28078
#&gt; [15,] 16.32581 16.14318 15.96054 15.77790 15.59527 15.41263 15.23000
#&gt; [16,] 16.10100 15.94737 15.79374 15.64011 15.48647 15.33284 15.17921
#&gt; [17,] 15.87619 15.75156 15.62693 15.50231 15.37768 15.25305 15.12843
#&gt; [18,] 15.65137 15.55575 15.46013 15.36451 15.26889 15.17327 15.07764
#&gt; [19,] 15.42656 15.35994 15.29333 15.22671 15.16009 15.09348 15.02686
#&gt; [20,] 15.20174 15.16413 15.12652 15.08891 15.05130 15.01369 14.97608
#&gt; [21,] 14.97693 14.96832 14.95972 14.95111 14.94251 14.93390 14.92529
#&gt; [22,] 14.75212 14.77252 14.79291 14.81331 14.83371 14.85411 14.87451
#&gt; [23,] 14.52730 14.57671 14.62611 14.67551 14.72492 14.77432 14.82372
#&gt; [24,] 14.30249 14.38090 14.45931 14.53771 14.61612 14.69453 14.77294
#&gt; [25,] 14.07768 14.18509 14.29250 14.39992 14.50733 14.61474 14.72216
#&gt; [26,] 13.85286 13.98928 14.12570 14.26212 14.39854 14.53495 14.67137
#&gt;            330      340      350      360      370      380      390
#&gt;  [1,] 15.35227 14.76356 14.17486 13.58615 12.99744 12.40874 11.82003
#&gt;  [2,] 15.33049 14.77079 14.21109 13.65139 13.09169 12.53198 11.97228
#&gt;  [3,] 15.30871 14.77801 14.24732 13.71662 13.18593 12.65523 12.12453
#&gt;  [4,] 15.28693 14.78524 14.28355 13.78186 13.28017 12.77848 12.27679
#&gt;  [5,] 15.26515 14.79246 14.31978 13.84709 13.37441 12.90172 12.42904
#&gt;  [6,] 15.24337 14.79969 14.35601 13.91233 13.46865 13.02497 12.58129
#&gt;  [7,] 15.22159 14.80692 14.39224 13.97756 13.56289 13.14821 12.73354
#&gt;  [8,] 15.19981 14.81414 14.42847 14.04280 13.65713 13.27146 12.88579
#&gt;  [9,] 15.17803 14.82137 14.46470 14.10804 13.75137 13.39470 13.03804
#&gt; [10,] 15.15626 14.82859 14.50093 14.17327 13.84561 13.51795 13.19029
#&gt; [11,] 15.13448 14.83582 14.53716 14.23851 13.93985 13.64120 13.34254
#&gt; [12,] 15.11270 14.84305 14.57339 14.30374 14.03409 13.76444 13.49479
#&gt; [13,] 15.09092 14.85027 14.60963 14.36898 14.12833 13.88769 13.64704
#&gt; [14,] 15.06914 14.85750 14.64586 14.43422 14.22257 14.01093 13.79929
#&gt; [15,] 15.04736 14.86472 14.68209 14.49945 14.31681 14.13418 13.95154
#&gt; [16,] 15.02558 14.87195 14.71832 14.56469 14.41106 14.25742 14.10379
#&gt; [17,] 15.00380 14.87918 14.75455 14.62992 14.50530 14.38067 14.25604
#&gt; [18,] 14.98202 14.88640 14.79078 14.69516 14.59954 14.50392 14.40829
#&gt; [19,] 14.96024 14.89363 14.82701 14.76039 14.69378 14.62716 14.56055
#&gt; [20,] 14.93846 14.90085 14.86324 14.82563 14.78802 14.75041 14.71280
#&gt; [21,] 14.91669 14.90808 14.89947 14.89087 14.88226 14.87365 14.86505
#&gt; [22,] 14.89491 14.91530 14.93570 14.95610 14.97650 14.99690 15.01730
#&gt; [23,] 14.87313 14.92253 14.97193 15.02134 15.07074 15.12014 15.16955
#&gt; [24,] 14.85135 14.92976 15.00817 15.08657 15.16498 15.24339 15.32180
#&gt; [25,] 14.82957 14.93698 15.04440 15.15181 15.25922 15.36664 15.47405
#&gt; [26,] 14.80779 14.94421 15.08063 15.21704 15.35346 15.48988 15.62630
#&gt;            400      410      420       430       440       450       460
#&gt;  [1,] 11.23133 10.64262 10.05392  9.465211  8.876505  8.287800  7.699094
#&gt;  [2,] 11.41258 10.85288 10.29318  9.733481  9.173781  8.614080  8.054380
#&gt;  [3,] 11.59384 11.06314 10.53245 10.001752  9.471056  8.940361  8.409665
#&gt;  [4,] 11.77509 11.27340 10.77171 10.270022  9.768332  9.266641  8.764950
#&gt;  [5,] 11.95635 11.48366 11.01098 10.538293 10.065607  9.592921  9.120236
#&gt;  [6,] 12.13761 11.69392 11.25024 10.806563 10.362883  9.919202  9.475521
#&gt;  [7,] 12.31886 11.90419 11.48951 11.074834 10.660158 10.245482  9.830806
#&gt;  [8,] 12.50012 12.11445 11.72878 11.343104 10.957433 10.571762 10.186092
#&gt;  [9,] 12.68137 12.32471 11.96804 11.611375 11.254709 10.898043 10.541377
#&gt; [10,] 12.86263 12.53497 12.20731 11.879645 11.551984 11.224323 10.896662
#&gt; [11,] 13.04388 12.74523 12.44657 12.147916 11.849260 11.550604 11.251948
#&gt; [12,] 13.22514 12.95549 12.68584 12.416186 12.146535 11.876884 11.607233
#&gt; [13,] 13.40640 13.16575 12.92510 12.684457 12.443810 12.203164 11.962518
#&gt; [14,] 13.58765 13.37601 13.16437 12.952727 12.741086 12.529445 12.317804
#&gt; [15,] 13.76891 13.58627 13.40363 13.220998 13.038361 12.855725 12.673089
#&gt; [16,] 13.95016 13.79653 13.64290 13.489268 13.335637 13.182005 13.028374
#&gt; [17,] 14.13142 14.00679 13.88216 13.757538 13.632912 13.508286 13.383660
#&gt; [18,] 14.31267 14.21705 14.12143 14.025809 13.930188 13.834566 13.738945
#&gt; [19,] 14.49393 14.42731 14.36070 14.294079 14.227463 14.160847 14.094230
#&gt; [20,] 14.67518 14.63757 14.59996 14.562350 14.524738 14.487127 14.449515
#&gt; [21,] 14.85644 14.84783 14.83923 14.830620 14.822014 14.813407 14.804801
#&gt; [22,] 15.03770 15.05809 15.07849 15.098891 15.119289 15.139688 15.160086
#&gt; [23,] 15.21895 15.26835 15.31776 15.367161 15.416565 15.465968 15.515371
#&gt; [24,] 15.40021 15.47862 15.55702 15.635432 15.713840 15.792248 15.870657
#&gt; [25,] 15.58146 15.68888 15.79629 15.903702 16.011116 16.118529 16.225942
#&gt; [26,] 15.76272 15.89914 16.03555 16.171973 16.308391 16.444809 16.581227
#&gt;             470       480       490       500
#&gt;  [1,]  7.110389  6.521683  5.932978  5.344272
#&gt;  [2,]  7.494679  6.934978  6.375278  5.815577
#&gt;  [3,]  7.878969  7.348274  6.817578  6.286882
#&gt;  [4,]  8.263260  7.761569  7.259878  6.758187
#&gt;  [5,]  8.647550  8.174864  7.702178  7.229492
#&gt;  [6,]  9.031840  8.588159  8.144478  7.700798
#&gt;  [7,]  9.416130  9.001454  8.586779  8.172103
#&gt;  [8,]  9.800421  9.414750  9.029079  8.643408
#&gt;  [9,] 10.184711  9.828045  9.471379  9.114713
#&gt; [10,] 10.569001 10.241340  9.913679  9.586018
#&gt; [11,] 10.953291 10.654635 10.355979 10.057323
#&gt; [12,] 11.337582 11.067931 10.798280 10.528628
#&gt; [13,] 11.721872 11.481226 11.240580 10.999934
#&gt; [14,] 12.106162 11.894521 11.682880 11.471239
#&gt; [15,] 12.490453 12.307816 12.125180 11.942544
#&gt; [16,] 12.874743 12.721112 12.567480 12.413849
#&gt; [17,] 13.259033 13.134407 13.009781 12.885154
#&gt; [18,] 13.643323 13.547702 13.452081 13.356459
#&gt; [19,] 14.027614 13.960997 13.894381 13.827764
#&gt; [20,] 14.411904 14.374293 14.336681 14.299070
#&gt; [21,] 14.796194 14.787588 14.778981 14.770375
#&gt; [22,] 15.180485 15.200883 15.221281 15.241680
#&gt; [23,] 15.564775 15.614178 15.663582 15.712985
#&gt; [24,] 15.949065 16.027474 16.105882 16.184290
#&gt; [25,] 16.333355 16.440769 16.548182 16.655595
#&gt; [26,] 16.717646 16.854064 16.990482 17.126900

rownames(grid_wide) &lt;- seq(50, 300, by = 10)</code></pre>
<pre class="r"><code>xaxis &lt;- list(
  title = &quot;hp&quot;
  #range = c(50, 300)
)

yaxis &lt;- list(
  title = &quot;disp&quot;
  #range = c(50, 500)
)

zaxis &lt;- list(
  title = &quot;mpg&quot;
  #range = c(10, 30)
)

p &lt;- plot_ly(z = ~grid_wide, 
             x = seq(50, 300, by = 10),
             y = seq(50, 500, by = 10)) %&gt;% 
  add_surface(
  contours = list(
    z = list(
      show=TRUE,
      usecolormap=TRUE,
      highlightcolor=&quot;#ff0000&quot;
      #project=list(z=TRUE)
      )
    )
  ) %&gt;%
    layout(
    title = &quot;lm1 as 3d plane&quot;,
    scene = list(
      xaxis = xaxis,
      yaxis = yaxis,
      zaxis = zaxis
    ))

p</code></pre>
<div id="htmlwidget-1" style="width:70%;height:355.968px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"5a9d37d2c3da":["function () ","plotlyVisDat"]},"cur_data":"5a9d37d2c3da","attrs":{"5a9d37d2c3da":{"z":{},"x":[50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],"y":[50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","contours":{"z":{"show":true,"usecolormap":true,"highlightcolor":"#ff0000"}},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"lm1 as 3d plane","scene":{"xaxis":{"title":"hp"},"yaxis":{"title":"disp"},"zaxis":{"title":"mpg"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"grid_wide","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[31.8360228286082,31.2473172531058,30.6586116776035,30.0699061021011,29.4812005265988,28.8924949510964,28.3037893755941,27.7150838000917,27.1263782245893,26.537672649087,25.9489670735846,25.3602614980823,24.7715559225799,24.1828503470776,23.5941447715752,23.0054391960729,22.4167336205705,21.8280280450682,21.2393224695658,20.6506168940635,20.0619113185611,19.4732057430588,18.8845001675564,18.2957945920541,17.7070890165517,17.1183834410493,16.529677865547,15.9409722900446,15.3522667145423,14.7635611390399,14.1748555635376,13.5861499880352,12.9974444125329,12.4087388370305,11.8200332615282,11.2313276860258,10.6426221105235,10.0539165350211,9.46521095951876,8.87650538401641,8.28779980851406,7.6990942330117,7.11038865750935,6.521683082007,5.93297750650465,5.34427193100229],[31.0021050846112,30.4424044621226,29.882703839634,29.3230032171454,28.7633025946567,28.2036019721681,27.6439013496795,27.0842007271909,26.5245001047022,25.9647994822136,25.405098859725,24.8453982372364,24.2856976147477,23.7259969922591,23.1662963697705,22.6065957472819,22.0468951247933,21.4871945023046,20.927493879816,20.3677932573274,19.8080926348388,19.2483920123501,18.6886913898615,18.1289907673729,17.5692901448843,17.0095895223956,16.449888899907,15.8901882774184,15.3304876549298,14.7707870324412,14.2110864099525,13.6513857874639,13.0916851649753,12.5319845424867,11.972283919998,11.4125832975094,10.8528826750208,10.2931820525322,9.73348143004354,9.17378080755492,8.6140801850663,8.05437956257767,7.49467894008905,6.93497831760043,6.3752776951118,5.81557707262317],[30.1681873406143,29.6374916711394,29.1067960016645,28.5761003321896,28.0454046627147,27.5147089932398,26.9840133237649,26.45331765429,25.9226219848151,25.3919263153402,24.8612306458654,24.3305349763905,23.7998393069156,23.2691436374407,22.7384479679658,22.2077522984909,21.677056629016,21.1463609595411,20.6156652900662,20.0849696205913,19.5542739511164,19.0235782816415,18.4928826121666,17.9621869426917,17.4314912732168,16.9007956037419,16.3700999342671,15.8394042647922,15.3087085953173,14.7780129258424,14.2473172563675,13.7166215868926,13.1859259174177,12.6552302479428,12.1245345784679,11.593838908993,11.0631432395181,10.5324475700432,10.0017519005683,9.47105623109343,8.94036056161854,8.40966489214365,7.87896922266876,7.34827355319386,6.81757788371897,6.28688221424407],[29.3342695966174,28.8325788801562,28.330888163695,27.8291974472339,27.3275067307727,26.8258160143115,26.3241252978504,25.8224345813892,25.320743864928,24.8190531484669,24.3173624320057,23.8156717155445,23.3139809990834,22.8122902826222,22.3105995661611,21.8089088496999,21.3072181332387,20.8055274167776,20.3038367003164,19.8021459838552,19.3004552673941,18.7987645509329,18.2970738344717,17.7953831180106,17.2936924015494,16.7920016850882,16.2903109686271,15.7886202521659,15.2869295357048,14.7852388192436,14.2835481027824,13.7818573863213,13.2801666698601,12.7784759533989,12.2767852369378,11.7750945204766,11.2734038040154,10.7717130875543,10.2700223710931,9.76833165463195,9.26664093817078,8.76495022170962,8.26325950524845,7.76156878878729,7.25987807232613,6.75818735586495],[28.5003518526204,28.027666089173,27.5549803257255,27.0822945622781,26.6096087988307,26.1369230353832,25.6642372719358,25.1915515084884,24.7188657450409,24.2461799815935,23.7734942181461,23.3008084546986,22.8281226912512,22.3554369278038,21.8827511643563,21.4100654009089,20.9373796374615,20.464693874014,19.9920081105666,19.5193223471192,19.0466365836717,18.5739508202243,18.1012650567768,17.6285792933294,17.155893529882,16.6832077664345,16.2105220029871,15.7378362395397,15.2651504760922,14.7924647126448,14.3197789491974,13.8470931857499,13.3744074223025,12.9017216588551,12.4290358954076,11.9563501319602,11.4836643685128,11.0109786050653,10.5382928416179,10.0656070781705,9.59292131472302,9.12023555127559,8.64754978782815,8.17486402438072,7.70217826093328,7.22949249748584],[27.6664341086235,27.2227532981898,26.7790724877561,26.3353916773224,25.8917108668886,25.4480300564549,25.0043492460212,24.5606684355875,24.1169876251538,23.6733068147201,23.2296260042864,22.7859451938527,22.342264383419,21.8985835729853,21.4549027625516,21.0112219521179,20.5675411416842,20.1238603312505,19.6801795208168,19.2364987103831,18.7928178999494,18.3491370895157,17.905456279082,17.4617754686482,17.0180946582145,16.5744138477808,16.1307330373471,15.6870522269134,15.2433714164797,14.799690606046,14.3560097956123,13.9123289851786,13.4686481747449,13.0249673643112,12.5812865538775,12.1376057434438,11.6939249330101,11.2502441225764,10.8065633121427,10.362882501709,9.91920169127526,9.47552088084156,9.03184007040785,8.58815925997415,8.14447844954044,7.70079763910673],[26.8325163646265,26.4178405072066,26.0031646497866,25.5884887923666,25.1738129349466,24.7591370775266,24.3444612201067,23.9297853626867,23.5151095052667,23.1004336478467,22.6857577904268,22.2710819330068,21.8564060755868,21.4417302181668,21.0270543607469,20.6123785033269,20.1977026459069,19.7830267884869,19.368350931067,18.953675073647,18.538999216227,18.124323358807,17.7096475013871,17.2949716439671,16.8802957865471,16.4656199291271,16.0509440717072,15.6362682142872,15.2215923568672,14.8069164994472,14.3922406420273,13.9775647846073,13.5628889271873,13.1482130697673,12.7335372123474,12.3188613549274,11.9041854975074,11.4895096400874,11.0748337826675,10.6601579252475,10.2454820678275,9.83080621040753,9.41613035298755,9.00145449556758,8.5867786381476,8.17210278072762],[25.9985986206296,25.6129277162233,25.2272568118171,24.8415859074108,24.4559150030046,24.0702440985984,23.6845731941921,23.2989022897859,22.9132313853796,22.5275604809734,22.1418895765671,21.7562186721609,21.3705477677546,20.9848768633484,20.5992059589421,20.2135350545359,19.8278641501296,19.4421932457234,19.0565223413172,18.6708514369109,18.2851805325047,17.8995096280984,17.5138387236922,17.1281678192859,16.7424969148797,16.3568260104734,15.9711551060672,15.5854842016609,15.1998132972547,14.8141423928484,14.4284714884422,14.042800584036,13.6571296796297,13.2714587752235,12.8857878708172,12.500116966411,12.1144460620047,11.7287751575985,11.3431042531922,10.957433348786,10.5717624443797,10.1860915399735,9.80042063556725,9.41474973116101,9.02907882675476,8.6434079223485],[25.1646808766326,24.8080149252401,24.4513489738476,24.0946830224551,23.7380170710626,23.3813511196701,23.0246851682775,22.668019216885,22.3113532654925,21.9546873141,21.5980213627075,21.241355411315,20.8846894599224,20.5280235085299,20.1713575571374,19.8146916057449,19.4580256543524,19.1013597029599,18.7446937515673,18.3880278001748,18.0313618487823,17.6746958973898,17.3180299459973,16.9613639946048,16.6046980432122,16.2480320918197,15.8913661404272,15.5347001890347,15.1780342376422,14.8213682862497,14.4647023348571,14.1080363834646,13.7513704320721,13.3947044806796,13.0380385292871,12.6813725778946,12.324706626502,11.9680406751095,11.611374723717,11.2547087723245,10.898042820932,10.5413768695395,10.1847109181469,9.82804496675443,9.47137901536192,9.11471306396939],[24.3307631326357,24.0031021342569,23.6754411358781,23.3477801374993,23.0201191391206,22.6924581407418,22.364797142363,22.0371361439842,21.7094751456054,21.3818141472266,21.0541531488478,20.726492150469,20.3988311520903,20.0711701537115,19.7435091553327,19.4158481569539,19.0881871585751,18.7605261601963,18.4328651618175,18.1052041634387,17.77754316506,17.4498821666812,17.1222211683024,16.7945601699236,16.4668991715448,16.139238173166,15.8115771747872,15.4839161764085,15.1562551780297,14.8285941796509,14.5009331812721,14.1732721828933,13.8456111845145,13.5179501861357,13.1902891877569,12.8626281893782,12.5349671909994,12.2073061926206,11.8796451942418,11.551984195863,11.2243231974842,10.8966621991054,10.5690012007266,10.2413402023479,9.91367920396907,9.58601820559028],[23.4968453886388,23.1981893432737,22.8995332979086,22.6008772525436,22.3022212071785,22.0035651618135,21.7049091164484,21.4062530710834,21.1075970257183,20.8089409803532,20.5102849349882,20.2116288896231,19.9129728442581,19.614316798893,19.315660753528,19.0170047081629,18.7183486627978,18.4196926174328,18.1210365720677,17.8223805267027,17.5237244813376,17.2250684359726,16.9264123906075,16.6277563452424,16.3291002998774,16.0304442545123,15.7317882091473,15.4331321637822,15.1344761184172,14.8358200730521,14.537164027687,14.238507982322,13.9398519369569,13.6411958915919,13.3425398462268,13.0438838008617,12.7452277554967,12.4465717101316,12.1479156647666,11.8492596194015,11.5506035740365,11.2519475286714,10.9532914833064,10.6546354379413,10.3559793925762,10.0573233472112],[22.6629276446418,22.3932765522905,22.1236254599392,21.8539743675878,21.5843232752365,21.3146721828852,21.0450210905339,20.7753699981825,20.5057189058312,20.2360678134799,19.9664167211285,19.6967656287772,19.4271145364259,19.1574634440746,18.8878123517232,18.6181612593719,18.3485101670206,18.0788590746692,17.8092079823179,17.5395568899666,17.2699057976153,17.0002547052639,16.7306036129126,16.4609525205613,16.1913014282099,15.9216503358586,15.6519992435073,15.382348151156,15.1126970588046,14.8430459664533,14.573394874102,14.3037437817507,14.0340926893993,13.764441597048,13.4947905046967,13.2251394123453,12.955488319994,12.6858372276427,12.4161861352914,12.14653504294,11.8768839505887,11.6072328582374,11.337581765886,11.0679306735347,10.7982795811834,10.5286284888321],[21.8290099006449,21.5883637613073,21.3477176219697,21.1070714826321,20.8664253432945,20.6257792039569,20.3851330646193,20.1444869252817,19.9038407859441,19.6631946466065,19.4225485072689,19.1819023679313,18.9412562285937,18.7006100892561,18.4599639499185,18.2193178105809,17.9786716712433,17.7380255319057,17.4973793925681,17.2567332532305,17.0160871138929,16.7754409745553,16.5347948352177,16.2941486958801,16.0535025565425,15.8128564172049,15.5722102778673,15.3315641385297,15.0909179991921,14.8502718598545,14.6096257205169,14.3689795811793,14.1283334418417,13.8876873025041,13.6470411631665,13.4063950238289,13.1657488844913,12.9251027451537,12.6844566058161,12.4438104664785,12.2031643271409,11.9625181878033,11.7218720484657,11.4812259091282,11.2405797697906,10.9999336304529],[20.9950921566479,20.7834509703241,20.5718097840002,20.3601685976763,20.1485274113525,19.9368862250286,19.7252450387047,19.5136038523809,19.301962666057,19.0903214797331,18.8786802934092,18.6670391070854,18.4553979207615,18.2437567344376,18.0321155481138,17.8204743617899,17.608833175466,17.3971919891422,17.1855508028183,16.9739096164944,16.7622684301706,16.5506272438467,16.3389860575228,16.127344871199,15.9157036848751,15.7040624985512,15.4924213122273,15.2807801259035,15.0691389395796,14.8574977532557,14.6458565669319,14.434215380608,14.2225741942841,14.0109330079603,13.7992918216364,13.5876506353125,13.3760094489887,13.1643682626648,12.9527270763409,12.7410858900171,12.5294447036932,12.3178035173693,12.1061623310454,11.8945211447216,11.6828799583977,11.4712387720738],[20.161174412651,19.9785381793409,19.7959019460307,19.6132657127206,19.4306294794104,19.2479932461003,19.0653570127902,18.88272077948,18.7000845461699,18.5174483128597,18.3348120795496,18.1521758462395,17.9695396129293,17.7869033796192,17.604267146309,17.4216309129989,17.2389946796888,17.0563584463786,16.8737222130685,16.6910859797584,16.5084497464482,16.3258135131381,16.1431772798279,15.9605410465178,15.7779048132077,15.5952685798975,15.4126323465874,15.2299961132772,15.0473598799671,14.864723646657,14.6820874133468,14.4994511800367,14.3168149467265,14.1341787134164,13.9515424801063,13.7689062467961,13.586270013486,13.4036337801758,13.2209975468657,13.0383613135556,12.8557250802454,12.6730888469353,12.4904526136252,12.307816380315,12.1251801470049,11.9425439136947],[19.3272566686541,19.1736253883576,19.0199941080612,18.8663628277648,18.7127315474684,18.559100267172,18.4054689868756,18.2518377065792,18.0982064262828,17.9445751459864,17.79094386569,17.6373125853935,17.4836813050971,17.3300500248007,17.1764187445043,17.0227874642079,16.8691561839115,16.7155249036151,16.5618936233187,16.4082623430223,16.2546310627259,16.1009997824294,15.947368502133,15.7937372218366,15.6401059415402,15.4864746612438,15.3328433809474,15.179212100651,15.0255808203546,14.8719495400582,14.7183182597618,14.5646869794654,14.4110556991689,14.2574244188725,14.1037931385761,13.9501618582797,13.7965305779833,13.6428992976869,13.4892680173905,13.3356367370941,13.1820054567977,13.0283741765013,12.8747428962049,12.7211116159084,12.567480335612,12.4138490553156],[18.4933389246571,18.3687125973744,18.2440862700918,18.1194599428091,17.9948336155264,17.8702072882437,17.745580960961,17.6209546336784,17.4963283063957,17.371701979113,17.2470756518303,17.1224493245476,16.997822997265,16.8731966699823,16.7485703426996,16.6239440154169,16.4993176881342,16.3746913608515,16.2500650335689,16.1254387062862,16.0008123790035,15.8761860517208,15.7515597244381,15.6269333971555,15.5023070698728,15.3776807425901,15.2530544153074,15.1284280880247,15.0038017607421,14.8791754334594,14.7545491061767,14.629922778894,14.5052964516113,14.3806701243287,14.256043797046,14.1314174697633,14.0067911424806,13.8821648151979,13.7575384879153,13.6329121606326,13.5082858333499,13.3836595060672,13.2590331787845,13.1344068515019,13.0097805242192,12.8851541969365],[17.6594211806602,17.5637998063912,17.4681784321223,17.3725570578533,17.2769356835844,17.1813143093154,17.0856929350465,16.9900715607775,16.8944501865086,16.7988288122396,16.7032074379707,16.6075860637017,16.5119646894328,16.4163433151638,16.3207219408949,16.2251005666259,16.129479192357,16.033857818088,15.9382364438191,15.8426150695501,15.7469936952812,15.6513723210122,15.5557509467433,15.4601295724743,15.3645081982054,15.2688868239364,15.1732654496675,15.0776440753985,14.9820227011296,14.8864013268606,14.7907799525917,14.6951585783227,14.5995372040537,14.5039158297848,14.4082944555159,14.3126730812469,14.2170517069779,14.121430332709,14.02580895844,13.9301875841711,13.8345662099021,13.7389448356332,13.6433234613642,13.5477020870953,13.4520807128263,13.3564593385574],[16.8255034366632,16.758887015408,16.6922705941528,16.6256541728976,16.5590377516423,16.4924213303871,16.4258049091319,16.3591884878767,16.2925720666215,16.2259556453662,16.159339224111,16.0927228028558,16.0261063816006,15.9594899603454,15.8928735390901,15.8262571178349,15.7596406965797,15.6930242753245,15.6264078540693,15.559791432814,15.4931750115588,15.4265585903036,15.3599421690484,15.2933257477931,15.2267093265379,15.1600929052827,15.0934764840275,15.0268600627723,14.960243641517,14.8936272202618,14.8270107990066,14.7603943777514,14.6937779564962,14.6271615352409,14.5605451139857,14.4939286927305,14.4273122714753,14.3606958502201,14.2940794289648,14.2274630077096,14.1608465864544,14.0942301651992,14.0276137439439,13.9609973226887,13.8943809014335,13.8277644801783],[15.9915856926663,15.9539742244248,15.9163627561833,15.8787512879418,15.8411398197003,15.8035283514588,15.7659168832173,15.7283054149758,15.6906939467344,15.6530824784929,15.6154710102514,15.5778595420099,15.5402480737684,15.5026366055269,15.4650251372854,15.4274136690439,15.3898022008024,15.3521907325609,15.3145792643194,15.276967796078,15.2393563278365,15.201744859595,15.1641333913535,15.126521923112,15.0889104548705,15.051298986629,15.0136875183875,14.976076050146,14.9384645819045,14.900853113663,14.8632416454215,14.82563017718,14.7880187089386,14.7504072406971,14.7127957724556,14.6751843042141,14.6375728359726,14.5999613677311,14.5623498994896,14.5247384312481,14.4871269630066,14.4495154947651,14.4119040265236,14.3742925582822,14.3366810900407,14.2990696217992],[15.1576679486693,15.1490614334416,15.1404549182138,15.1318484029861,15.1232418877583,15.1146353725305,15.1060288573028,15.097422342075,15.0888158268473,15.0802093116195,15.0716027963917,15.062996281164,15.0543897659362,15.0457832507084,15.0371767354807,15.0285702202529,15.0199637050252,15.0113571897974,15.0027506745696,14.9941441593419,14.9855376441141,14.9769311288863,14.9683246136586,14.9597180984308,14.9511115832031,14.9425050679753,14.9338985527475,14.9252920375198,14.916685522292,14.9080790070643,14.8994724918365,14.8908659766087,14.882259461381,14.8736529461532,14.8650464309254,14.8564399156977,14.8478334004699,14.8392268852422,14.8306203700144,14.8220138547866,14.8134073395589,14.8048008243311,14.7961943091033,14.7875877938756,14.7789812786478,14.7703747634201],[14.3237502046724,14.3441486424584,14.3645470802443,14.3849455180303,14.4053439558163,14.4257423936022,14.4461408313882,14.4665392691742,14.4869377069601,14.5073361447461,14.5277345825321,14.5481330203181,14.568531458104,14.58892989589,14.609328333676,14.6297267714619,14.6501252092479,14.6705236470339,14.6909220848198,14.7113205226058,14.7317189603918,14.7521173981777,14.7725158359637,14.7929142737497,14.8133127115356,14.8337111493216,14.8541095871076,14.8745080248935,14.8949064626795,14.9153049004655,14.9357033382514,14.9561017760374,14.9765002138234,14.9968986516093,15.0172970893953,15.0376955271813,15.0580939649672,15.0784924027532,15.0988908405392,15.1192892783251,15.1396877161111,15.1600861538971,15.180484591683,15.200883029469,15.221281467255,15.2416799050409],[13.4898324606755,13.5392358514752,13.5886392422749,13.6380426330746,13.6874460238743,13.736849414674,13.7862528054736,13.8356561962733,13.885059587073,13.9344629778727,13.9838663686724,14.0332697594721,14.0826731502718,14.1320765410715,14.1814799318712,14.2308833226709,14.2802867134706,14.3296901042703,14.37909349507,14.4284968858697,14.4779002766694,14.5273036674691,14.5767070582688,14.6261104490685,14.6755138398682,14.7249172306679,14.7743206214676,14.8237240122673,14.873127403067,14.9225307938667,14.9719341846664,15.0213375754661,15.0707409662658,15.1201443570655,15.1695477478652,15.2189511386649,15.2683545294646,15.3177579202643,15.367161311064,15.4165647018637,15.4659680926633,15.515371483463,15.5647748742627,15.6141782650624,15.6635816558621,15.7129850466618],[12.6559147166785,12.7343230604919,12.8127314043054,12.8911397481188,12.9695480919322,13.0479564357457,13.1263647795591,13.2047731233725,13.2831814671859,13.3615898109994,13.4399981548128,13.5184064986262,13.5968148424396,13.6752231862531,13.7536315300665,13.8320398738799,13.9104482176934,13.9888565615068,14.0672649053202,14.1456732491336,14.2240815929471,14.3024899367605,14.3808982805739,14.4593066243873,14.5377149682008,14.6161233120142,14.6945316558276,14.772939999641,14.8513483434545,14.9297566872679,15.0081650310813,15.0865733748947,15.1649817187082,15.2433900625216,15.321798406335,15.4002067501485,15.4786150939619,15.5570234377753,15.6354317815887,15.7138401254022,15.7922484692156,15.870656813029,15.9490651568424,16.0274735006559,16.1058818444693,16.1842901882827],[11.8219969726816,11.9294102695087,12.0368235663359,12.144236863163,12.2516501599902,12.3590634568174,12.4664767536445,12.5738900504717,12.6813033472988,12.788716644126,12.8961299409531,13.0035432377803,13.1109565346075,13.2183698314346,13.3257831282618,13.4331964250889,13.5406097219161,13.6480230187432,13.7554363155704,13.8628496123976,13.9702629092247,14.0776762060519,14.185089502879,14.2925027997062,14.3999160965333,14.5073293933605,14.6147426901876,14.7221559870148,14.829569283842,14.9369825806691,15.0443958774963,15.1518091743234,15.2592224711506,15.3666357679777,15.4740490648049,15.581462361632,15.6888756584592,15.7962889552864,15.9037022521135,16.0111155489407,16.1185288457678,16.225942142595,16.3333554394221,16.4407687362493,16.5481820330765,16.6555953299036],[10.9880792286846,11.1244974785255,11.2609157283664,11.3973339782073,11.5337522280482,11.6701704778891,11.80658872773,11.9430069775708,12.0794252274117,12.2158434772526,12.3522617270935,12.4886799769344,12.6250982267753,12.7615164766162,12.897934726457,13.0343529762979,13.1707712261388,13.3071894759797,13.4436077258206,13.5800259756615,13.7164442255024,13.8528624753432,13.9892807251841,14.125698975025,14.2621172248659,14.3985354747068,14.5349537245477,14.6713719743886,14.8077902242294,14.9442084740703,15.0806267239112,15.2170449737521,15.353463223593,15.4898814734339,15.6262997232748,15.7627179731156,15.8991362229565,16.0355544727974,16.1719727226383,16.3083909724792,16.4448092223201,16.581227472161,16.7176457220018,16.8540639718427,16.9904822216836,17.1269004715245]],"x":[50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],"y":[50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500],"type":"surface","contours":{"z":{"show":true,"usecolormap":true,"highlightcolor":"#ff0000"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="scatterplot-3d" class="section level2">
<h2>Scatterplot 3d</h2>
<p>First plot the scatterplot:</p>
<pre class="r"><code>d &lt;- mtcars %&gt;% 
  select(hp, disp, mpg)
lm1a &lt;- lm(d$mpg ~ d$hp + d$disp)



p3 &lt;- scatterplot3d(d)
</code></pre>
<p><img src="/post/2019-10-21-some-ways-for-plotting-3d-linear-models_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Now add the regression plane:</p>
<pre class="r"><code>p3$plane3d(lm1a)
#&gt; Error in segments(x, z1, x + y.max * yx.f, z2 + yz.f * y.max, lty = ltya, : plot.new has not been called yet</code></pre>
<p>For some reason, this code does not run in (my) rmarkdown setup, but it worked (on my machien) in a ordinary R script.</p>
</div>
</div>
