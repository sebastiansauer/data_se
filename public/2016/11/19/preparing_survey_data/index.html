<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.75.1" />


<title>Preparing survey results data - Data Se</title>
<meta property="og:title" content="Preparing survey results data - Data Se">



  








<link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo-data-se.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="/">Blog</a></li>
    
    <li><a href="/privacy/">Data privacy</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">13 min read</span>
    

    <h1 class="article-title">Preparing survey results data</h1>

    
    <span class="article-date">2016/11/19</span>
    

    <div class="article-content">
      <p>Analyzing survey results is a frequent endeavor (for some including me). Let&rsquo;s not think about arguments whether and when surveys are useful or not (for some recent criticism see <a href="http://www.springer.com/de/book/9783319397559">Briggs' book</a>).</p>
<p>Typically, respondents circle some option ranging from &ldquo;don&rsquo;t agree at all&rdquo; to &ldquo;completely agree&rdquo; for each question (or &ldquo;item&rdquo;). Typically, four to six boxes are given where one is expected to tick one.</p>
<p>In this tutorial, I will discuss some typical steps to prepare the data for subsequent analyses. The goal is that we have the dataset ready for analyzing with basic preparations (eg. recoding of reversed variables) already done.</p>
<p>Some needed packages.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(tidyverse)
<span style="color:#a6e22e">library</span>(forcats)  <span style="color:#75715e"># recoding</span>
<span style="color:#a6e22e">library</span>(psych)  <span style="color:#75715e"># testing for internal consistency</span>
</code></pre></div><h1 id="prepare-data">Prepare data</h1>
<p>So, first, let&rsquo;s load some data. That&rsquo;s a data set of a survey on extraversion. Folks were asked a bunch of questions tapping at their &ldquo;psychometric extraversion&rdquo;, and some related behavior, that is, behavior <em>supposed to</em> be related such as &ldquo;number of Facebook friends&rdquo;, &ldquo;how often at a party&rdquo; etc. Note that college students form the sample.</p>
<p>Data are available only (free as in free and free as in beer).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data_raw <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;https://sebastiansauer.github.io/data/extra_raw_WS16.csv&#34;</span>)

data <span style="color:#f92672">&lt;-</span> data_raw  <span style="color:#75715e"># backup just in case</span>
</code></pre></div><p>Here&rsquo;s the DOI of this data: 10.17605/OSF.IO/4KGZH.</p>
<p>OK, we got &lsquo;em; a dataset of dimension 501, 24. Let&rsquo;s glimpse at the data:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">glimpse</span>(data)
</code></pre></div><pre><code>## Observations: 501
## Variables: 24
## $ Zeitstempel                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            &lt;fctr&gt; ...
## $ Bitte.geben.Sie.Ihren.dreistellen.anonymen.Code.ein..1...Anfangsbuchstabe.des.Vornamens.Ihres.Vaters..2...Anfangsbuchstabe.des.Mädchennamens.Ihrer.Mutter..3..Anfangsbuchstabe.Ihres.Geburstsorts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &lt;fctr&gt; ...
## $ Ich.bin.gerne.mit.anderen.Menschen.zusammen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &lt;int&gt; ...
## $ Ich.bin.ein.Einzelgänger.....                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &lt;int&gt; ...
## $ Ich.bin.in.vielen.Vereinen.aktiv.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &lt;int&gt; ...
## $ Ich.bin.ein.gesprächiger.und.kommunikativer.Mensch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    &lt;int&gt; ...
## $ Ich.bin.sehr.kontaktfreudig.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &lt;int&gt; ...
## $ Im.Grunde.bin.ich.oft.lieber.für.mich.allein.....                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &lt;int&gt; ...
## $ Ich.kann.schnell.gute.Stimmung.verbreiten.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;int&gt; ...
## $ Ich.gehe.gerne.auf.Partys.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &lt;int&gt; ...
## $ Ich.bin.unternehmungslustig.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &lt;int&gt; ...
## $ Ich.stehe.gerne.im.Mittelpunkt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &lt;int&gt; ...
## $ Wie.viele.Facebook.Freunde..Kontakte..haben.Sie..wenn.Sie.nicht.bei.Facebook.sind..bitte.LEER.lassen..                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &lt;int&gt; ...
## $ Wie.viele..Kater...überreichlicher.Alkoholkonsum..hatten.Sie.in.den.letzten12.Monaten.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &lt;fctr&gt; ...
## $ Wie.alt.sind.Sie.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &lt;int&gt; ...
## $ Bitte.geben.Sie.Ihr.Geschlecht.an.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &lt;fctr&gt; ...
## $ Ich.würde.sagen..ich.bin.extrovertiert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;int&gt; ...
## $ Sie.gehen.alleine.auf.eine.Party..Nach.wie.viel.Minuten.sind.Sie.im.Gespräch.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &lt;fctr&gt; ...
## $ Es.wird.ein.Mitarbeiter..m.w..für.eine.Präsentation..Messe..gesucht..Melden.Sie.sich.freiwillig.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       &lt;fctr&gt; ...
## $ Wie.häufig.waren.Sie.in.den.letzten.12.Monaten.auf.einer.Party.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &lt;fctr&gt; ...
## $ Wie.oft.haben.Sie.Kundenkontakt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       &lt;fctr&gt; ...
## $ Passt.die.folgende.Beschreibung.auf.Sie...........Eine.extravertierte.Person.ist.jemand..der.seine.Energie.eher.nach.außen.richtet.und.weniger.in.die.innere.Welt.der.Gedanken..Ideen.oder.Vorstellungen..Daher.neigen.extravertierte.Menschen.dazu..in.neuen.Situationen.ohne.zu.zögern.sich.in.die.neue.Situationen.zu.begeben..Zum.Beispiel.würde.eine.extravertierte.Person..die.zum.ersten.Mal.einen.Yogakurs.besucht..sich.nicht.scheuen..direkt.bei.den.Übungen.mitzumachen..Oder.wenn.eine.extravertierte.Person.eine.Kneipe.zum.ersten.besucht..würde.sie.sich.nicht.unbehaglich.fühlen..Man.kann.daher.sagen..dass.extravertierte.Personen.als.aktiv.wahrgenommen.werden.und.sich.zu.Unternehmungen.hingezogen.fühlen..bei.denen.sie.mit.anderen.Personen.in.Kontakt.kommen. &lt;fctr&gt; ...
## $ X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &lt;lgl&gt; ...
## $ Wie.sehr.treffen.die.folgenden.Aussagen.auf.Sie.zu..Bitte.denken.Sie.dabei.nicht.an.spezifische.Situationen..sondern.ganz.allgemein..wie.sehr.die.Aussagen.Sie.selbst.in.den.meisten.Bereichen.und.Situationen.in.Ihrem.Leben.beschreiben.Allgemein.wirke.ich.tendenziell.eher.wie.eine.Person..die......                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &lt;int&gt; ...
</code></pre><h2 id="renaming">Renaming</h2>
<p>Looks like a jungle. Now what? Let&rsquo;s start with renaming the columns (variables).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">extra_colnames <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">names</span>(data)  <span style="color:#75715e"># save names in this vector</span>

<span style="color:#a6e22e">names</span>(data)[3<span style="color:#f92672">:</span><span style="color:#ae81ff">12</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34;i&#34;</span>, <span style="color:#a6e22e">formatC</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>), sep <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>) 
</code></pre></div><p>There&rsquo;s a saying that naming variables/objects in one of the hardest things in computer stuff. One time I renamed the columns from &ldquo;i01&rdquo; to &ldquo;i26&rdquo; or so. That&rsquo;s <em>different</em> to the naming scheme we used now! This ambivalence can lead to confusion (happened to me). That&rsquo;s why I now follow this rule:</p>
<ul>
<li>Renaming strange columns names -&gt; use <code>v01</code> to <code>v25</code> (or how many columns you have)</li>
<li>Renaming <em>items</em> of e.g. some questionnaire -&gt; use <code>01</code> to <code>i10</code> etc.</li>
</ul>
<p>Now columns 3 to 12 are now named &ldquo;i1&rdquo;, &ldquo;i2&rdquo;, etc. These columns reflect the items of a extraversion questionnaire.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">names</span>(data)[1] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;timestamp&#34;</span>
<span style="color:#a6e22e">names</span>(data)[2] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;code&#34;</span>
<span style="color:#a6e22e">names</span>(data)[13] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;n_facebook_friends&#34;</span> 
<span style="color:#a6e22e">names</span>(data)[14] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;n_hangover&#34;</span> 
<span style="color:#a6e22e">names</span>(data)[15] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;age&#34;</span>
<span style="color:#a6e22e">names</span>(data)[16] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;sex&#34;</span> 
<span style="color:#a6e22e">names</span>(data)[17] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;extra_single_item&#34;</span>
<span style="color:#a6e22e">names</span>(data)[18] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;time_conversation&#34;</span>
<span style="color:#a6e22e">names</span>(data)[19] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;presentation&#34;</span>
<span style="color:#a6e22e">names</span>(data)[20] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;n_party&#34;</span>
<span style="color:#a6e22e">names</span>(data)[21] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;clients&#34;</span>
<span style="color:#a6e22e">names</span>(data)[22] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;extra_vignette&#34;</span> 
<span style="color:#a6e22e">names</span>(data)[24] <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;extra_description&#34;</span> 
data<span style="color:#f92672">$</span>X <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">NULL</span>
</code></pre></div><h2 id="recoding">Recoding</h2>
<p>Importantly, two items are negatively coded; we need to recode them (ie., &ldquo;yes&rdquo; gets &ldquo;no&rdquo;, and vice versa).</p>
<p>They are:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">extra_colnames<span style="color:#a6e22e">[c</span>(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">8</span>)]
</code></pre></div><pre><code>## [1] &quot;Ich.bin.ein.Einzelgänger.....&quot;                    
## [2] &quot;Im.Grunde.bin.ich.oft.lieber.für.mich.allein.....&quot;
</code></pre><p>Double check whether <em>still</em> nothing is recoded (I&rsquo;ve run this code a couple of times already).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">identical</span>(data<span style="color:#f92672">$</span>i02, data_raw[[4]])
</code></pre></div><pre><code>## [1] TRUE
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">identical</span>(data<span style="color:#f92672">$</span>i06, data_raw[[8]])
</code></pre></div><pre><code>## [1] TRUE
</code></pre><p>OK.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">rename</span>(data, 
       i02r <span style="color:#f92672">=</span> i02,
       i06r <span style="color:#f92672">=</span> i06) <span style="color:#f92672">-&gt;</span> data

data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(i02r <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>(i02r, `1` <span style="color:#f92672">=</span> <span style="color:#ae81ff">4L</span>, `2` <span style="color:#f92672">=</span> <span style="color:#ae81ff">3L</span>, `3` <span style="color:#f92672">=</span> <span style="color:#ae81ff">2L</span>, `4` <span style="color:#f92672">=</span> <span style="color:#ae81ff">1L</span>),
         i06r <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>(i06r, `1` <span style="color:#f92672">=</span> <span style="color:#ae81ff">4L</span>, `2` <span style="color:#f92672">=</span> <span style="color:#ae81ff">3L</span>, `3` <span style="color:#f92672">=</span> <span style="color:#ae81ff">2L</span>, `4` <span style="color:#f92672">=</span> <span style="color:#ae81ff">1L</span>)) <span style="color:#f92672">-&gt;</span> data
</code></pre></div><p>This may lead us too far afield, but let&rsquo;s see whether the items correlate with each other, and each with the rest. We can compute Cronbach&rsquo;s Alpha for that purpose</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span> 
  psych<span style="color:#f92672">::</span><span style="color:#a6e22e">alpha</span>() <span style="color:#f92672">%&gt;%</span> 
  print
</code></pre></div><pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = .)
## 
##   raw_alpha std.alpha G6(smc) average_r S/N   ase mean   sd
##       0.78      0.79    0.81      0.28 3.9 0.015  2.9 0.46
## 
##  lower alpha upper     95% confidence boundaries
## 0.75 0.78 0.81 
## 
##  Reliability if an item is dropped:
##      raw_alpha std.alpha G6(smc) average_r S/N alpha se
## i01       0.75      0.76    0.77      0.26 3.2    0.017
## i02r      0.76      0.77    0.78      0.27 3.4    0.016
## i03       0.81      0.81    0.82      0.33 4.4    0.013
## i04       0.75      0.76    0.77      0.26 3.2    0.017
## i05       0.75      0.76    0.77      0.26 3.2    0.017
## i06r      0.76      0.77    0.78      0.27 3.4    0.016
## i07       0.76      0.77    0.79      0.27 3.4    0.016
## i08       0.76      0.78    0.79      0.28 3.5    0.016
## i09       0.77      0.78    0.79      0.28 3.6    0.016
## i10       0.78      0.79    0.80      0.30 3.8    0.015
## 
##  Item statistics 
##        n raw.r std.r r.cor r.drop mean   sd
## i01  499  0.69  0.71  0.68   0.60  3.3 0.68
## i02r 498  0.63  0.63  0.59   0.50  3.1 0.80
## i03  500  0.33  0.30  0.16   0.14  1.9 0.92
## i04  498  0.68  0.69  0.67   0.57  3.2 0.73
## i05  498  0.69  0.70  0.68   0.59  3.1 0.77
## i06r 499  0.62  0.62  0.57   0.50  2.9 0.77
## i07  498  0.62  0.62  0.57   0.50  3.0 0.73
## i08  499  0.61  0.60  0.53   0.47  2.9 0.86
## i09  499  0.55  0.57  0.49   0.43  3.4 0.71
## i10  498  0.51  0.49  0.39   0.34  2.2 0.90
## 
## Non missing response frequency for each item
##         1    2    3    4 miss
## i01  0.01 0.08 0.46 0.45 0.00
## i02r 0.04 0.16 0.45 0.35 0.01
## i03  0.41 0.33 0.19 0.06 0.00
## i04  0.01 0.16 0.43 0.41 0.01
## i05  0.02 0.20 0.47 0.30 0.01
## i06r 0.05 0.18 0.54 0.22 0.00
## i07  0.02 0.21 0.54 0.23 0.01
## i08  0.06 0.23 0.44 0.27 0.00
## i09  0.01 0.10 0.41 0.47 0.00
## i10  0.21 0.43 0.26 0.10 0.01
</code></pre><p>Ok, looks good.</p>
<p>I suspect there are rows with <em>no</em> values at, complete blank. Let&rsquo;s compute the proportion of NAs per row.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">rowSums</span>(<span style="color:#a6e22e">is.na</span>(data))
</code></pre></div><pre><code>##   [1]  1  1  1  1  1  1  1  1  1  2  1  1  1  1  1  1  1  2  1  1  1  1  1
##  [24]  2  1  2  2  1  1  1  1  1  1  1  1  1  1  2  1  2  1  1  1  1  1  1
##  [47]  1  1  2  1  1  3  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##  [70]  1  1  1  1  1  1  1  2  1  1  1  1  1  1  1  1  1  1  1  1  2  2  1
##  [93]  1  2  1  1  1  2  2  1  1  2  1  1  3  1  1  1  1  2  1  2  1  1  1
## [116]  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  0  1  0  1  0
## [139]  1  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  0  2
## [162]  0  0  0  0  0  1  1  0  0  0  0  0  0  1  0  1  0  1  0  0  1  1  1
## [185]  1  0  3  0  2  0  0  0  0  0  0  1  1  0  0  0  0  1  1  0  0  0  0
## [208]  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  1  1
## [231]  1  1  0  1  1  0  1  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0
## [254]  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0
## [277]  0  1  0  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0
## [300]  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  2  0  0  0  0  0  0
## [323]  1  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  1  1  0  0  0
## [346]  0  0  0  1  0  0  2  0  0  0  0  1  1  0  0  0  0  0  0  0  0  1  0
## [369]  0  0  1  0  0  0  0  0  0  0  1  1  0  0  0  0  1  0  0  0  0  0  1
## [392]  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0
## [415]  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0  0  1  0  0  0
## [438]  0  0  0  1  1  0  1  0  0  0  0  0  0  0  0 14  1  1  0  1  0  1  0
## [461]  0  0  0  0  0 11  0  0  0  1  0  0  0  1  1  0  1  1  0  0  0  0  0
## [484]  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  1  0
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">table</span>(data<span style="color:#f92672">$</span>extra_description)
</code></pre></div><pre><code>## 
##   1   2   3   4   5   6   7   8  10 
##  31 118  98  68  44  12   5   1   1
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(prop_na_per_row <span style="color:#f92672">=</span> <span style="color:#a6e22e">rowSums</span>(<span style="color:#a6e22e">is.na</span>(data))<span style="color:#f92672">/</span><span style="color:#a6e22e">ncol</span>(data)) <span style="color:#f92672">-&gt;</span> data

<span style="color:#a6e22e">count</span>(data, prop_na_per_row) 
</code></pre></div><pre><code>## # A tibble: 6 × 2
##   prop_na_per_row     n
##             &lt;dbl&gt; &lt;int&gt;
## 1      0.00000000   304
## 2      0.04347826   171
## 3      0.08695652    21
## 4      0.13043478     3
## 5      0.47826087     1
## 6      0.60869565     1
</code></pre><h2 id="rowwise-means-for-survey-etc">Rowwise means for survey etc.</h2>
<p>Let&rsquo;s compute the mean and the median extraversion.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(extra_mean <span style="color:#f92672">=</span> <span style="color:#a6e22e">rowMeans</span>(.[3<span style="color:#f92672">:</span><span style="color:#ae81ff">12</span>], na.rm <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>),
         extra_median <span style="color:#f92672">=</span> <span style="color:#a6e22e">apply</span>(.[3<span style="color:#f92672">:</span><span style="color:#ae81ff">12</span>], <span style="color:#ae81ff">1</span>, median, na.rm <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)) <span style="color:#f92672">-&gt;</span> data
</code></pre></div><h2 id="cleaning-data">Cleaning data</h2>
<p>The number of hangovers should be numeric, but it isn&rsquo;t. Let&rsquo;s see.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">count</span>(data, n_hangover) <span style="color:#f92672">%&gt;%</span> kable
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">n_hangover</th>
<th style="text-align:right">n</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"></td>
<td style="text-align:right">13</td>
</tr>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">98</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">59</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:right">38</td>
</tr>
<tr>
<td style="text-align:left">100</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">106</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:left">12</td>
<td style="text-align:right">18</td>
</tr>
<tr>
<td style="text-align:left">15</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:left">153</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">18</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:right">63</td>
</tr>
<tr>
<td style="text-align:left">20</td>
<td style="text-align:right">14</td>
</tr>
<tr>
<td style="text-align:left">200</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">24</td>
<td style="text-align:right">8</td>
</tr>
<tr>
<td style="text-align:left">25</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:left">28</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:right">42</td>
</tr>
<tr>
<td style="text-align:left">30</td>
<td style="text-align:right">11</td>
</tr>
<tr>
<td style="text-align:left">35</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:right">25</td>
</tr>
<tr>
<td style="text-align:left">40</td>
<td style="text-align:right">9</td>
</tr>
<tr>
<td style="text-align:left">48</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:right">38</td>
</tr>
<tr>
<td style="text-align:left">50</td>
<td style="text-align:right">6</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:right">15</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:left">70</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:right">7</td>
</tr>
<tr>
<td style="text-align:left">80</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:left">98</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">ca. 18-23</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">Keinen</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>OK, let&rsquo;s parse the numbers only; a typical problem in surveys is that respondent do not give numbers where you would like them to give numbers (some survey tools allow you to control what the respondent may put in the field).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data<span style="color:#f92672">$</span>n_hangover <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">parse_number</span>(data<span style="color:#f92672">$</span>n_hangover)
</code></pre></div><pre><code>## Warning: 2 parsing failures.
## row col expected actual
## 132  -- a number       
## 425  -- a number      .
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data<span style="color:#f92672">$</span>time_conversation <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">parse_number</span>(data<span style="color:#f92672">$</span>time_conversation)
</code></pre></div><pre><code>## Warning: 1 parsing failure.
## row col expected actual
## 153  -- a number
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data<span style="color:#f92672">$</span>n_party <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">parse_number</span>(data<span style="color:#f92672">$</span>n_party)
</code></pre></div><pre><code>## Warning: 1 parsing failure.
## row col expected actual
## 270  -- a number
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># data$n_clients &lt;- parse_number(data$clients)</span>
</code></pre></div><p>For the item &ldquo;how many clients do you see each weak&rdquo;, things are more difficult, see:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">count</span>(clients)
</code></pre></div><pre><code>## # A tibble: 19 × 2
##                                        clients     n
##                                         &lt;fctr&gt; &lt;int&gt;
## 1                                                 51
## 2                                            0     3
## 3                                          100     1
## 4                              3 Mal pro Woche     1
## 5                                    gar nicht     1
## 6                            habe keine Kunden     1
## 7                            ich arbeite ncht      1
## 8                Ich habe keinen Kundenkontakt     1
## 9                   im Schnitt 1 Mal pro Monat    30
## 10 im Schnitt 1 Mal pro Quartal (oder weniger)    51
## 11                    im Schnitt 1 Mal pro Tag    50
## 12                  im Schnitt 1 Mal pro Woche    78
## 13                 im Schnitt mehrfach pro Tag   225
## 14                                      keinen     1
## 15                                         nie     2
## 16                                         Nie     1
## 17                                          Nö     1
## 18                      täglich zwischen 20-50     1
## 19    Telfonisch täglich, Face to Face 1xWoche     1
</code></pre><p>There are some values/words indicating that the respondent does not see any clients at all. Let&rsquo;s recode them to &ldquo;I am not having personal contact to clients&rdquo; (or, shorter <code>no</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(client_freq <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>(clients, <span style="color:#e6db74">&#34;gar nicht&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34;habe keine Kunden&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34;keinen&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34;Nie&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34;Nö&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34;Ich habe keinen Kundenkontakt&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34;ich arbeite ncht &#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34;nie&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>,
                              <span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>)) <span style="color:#f92672">-&gt;</span> data

data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">count</span>(client_freq)
</code></pre></div><pre><code>## # A tibble: 11 × 2
##                                    client_freq     n
##                                         &lt;fctr&gt; &lt;int&gt;
## 1                                                 51
## 2                                            0    12
## 3                                          100     1
## 4                              3 Mal pro Woche     1
## 5                   im Schnitt 1 Mal pro Monat    30
## 6  im Schnitt 1 Mal pro Quartal (oder weniger)    51
## 7                     im Schnitt 1 Mal pro Tag    50
## 8                   im Schnitt 1 Mal pro Woche    78
## 9                  im Schnitt mehrfach pro Tag   225
## 10                      täglich zwischen 20-50     1
## 11    Telfonisch täglich, Face to Face 1xWoche     1
</code></pre><p>Ok, looks good, but still a bit work left.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(client_freq <span style="color:#f92672">=</span> <span style="color:#a6e22e">recode</span>(client_freq, <span style="color:#e6db74">&#34;100&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;3&#34;</span>,
                              <span style="color:#e6db74">&#34;im Schnitt 1 Mal pro Quartal (oder weniger)&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#34;</span>,
                              <span style="color:#e6db74">&#34;im Schnitt 1 Mal pro Monat&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2&#34;</span>,
                              <span style="color:#e6db74">&#34;im Schnitt 1 Mal pro Woche&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;3&#34;</span>,
                              <span style="color:#e6db74">&#34;im Schnitt 1 Mal pro Tag&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;4&#34;</span>,
                              <span style="color:#e6db74">&#34;im Schnitt mehrfach pro Tag&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;5&#34;</span>,
                              <span style="color:#e6db74">&#34;täglich zwischen 20-50&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;5&#34;</span>,
                              <span style="color:#e6db74">&#34;Telfonisch täglich, Face to Face 1xWoche&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;5&#34;</span>,
                              <span style="color:#e6db74">&#34;3 Mal pro Woche&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;4&#34;</span>)) <span style="color:#f92672">-&gt;</span> data

data<span style="color:#f92672">$</span>client_freq <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">factor</span>(data<span style="color:#f92672">$</span>client_freq)  <span style="color:#75715e"># drops unused levels</span>

data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">count</span>(client_freq)
</code></pre></div><pre><code>## # A tibble: 7 × 2
##   client_freq     n
##        &lt;fctr&gt; &lt;int&gt;
## 1                51
## 2           0    12
## 3           3    79
## 4           4    51
## 5           2    30
## 6           1    51
## 7           5   227
</code></pre><p>Finally, let&rsquo;s reorder the values from 0 to 5.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data<span style="color:#f92672">$</span>client_freq[data<span style="color:#f92672">$</span>client_freq <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span>] <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">NA</span>

data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(client_freq <span style="color:#f92672">=</span> <span style="color:#a6e22e">factor</span>(client_freq, levels <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#66d9ef">NA</span>))) <span style="color:#f92672">-&gt;</span> data
</code></pre></div><p>Pooh, what a mess. Better force respondent to select from a given set of answers, than we do not have that hassle.</p>
<h2 id="checking-nas-for-items">Checking NA&rsquo;s for items</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span>
  gather <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">is.na</span>(value)) <span style="color:#f92672">%&gt;%</span> 
  count
</code></pre></div><pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1    24
</code></pre><p>Hm, let&rsquo;s see in more detail.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">complete.cases</span>(.))
</code></pre></div><pre><code>##   i01 i02r i03 i04 i05 i06r i07 i08 i09 i10
## 1   4    4   3  NA   4    3   3   3   3   2
## 2   4    3   3   3   2    4  NA   4   4   3
## 3   3    3   1   2   3    3   2   1   3  NA
## 4   3    3   1  NA   3    2   3   2   3   1
## 5   4    1   1   4  NA    1   4   3   3   2
## 6   3   NA   2   3   2    4   2   2   4   2
## 7  NA   NA  NA  NA  NA   NA  NA  NA  NA  NA
## 8  NA   NA   2   2  NA   NA  NA  NA  NA  NA
</code></pre><p>Hm, not so many cases have NAs. Let&rsquo;s just exclude them, that&rsquo;s the easiest, and we will not lose much (many cases, that is).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">complete.cases</span>(.)) <span style="color:#f92672">%&gt;%</span> nrow
</code></pre></div><pre><code>## [1] 493
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span> 
  na.omit <span style="color:#f92672">-&gt;</span> data_items
</code></pre></div><p>So, we are more or less done now. Last thing we do, is to have a look at the distribution of <code>data_items</code> whether it looks plausible, as some kind of coarse sense check.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data_items <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span> 
  gather <span style="color:#f92672">%&gt;%</span> 
  ggplot <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> value) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_bar</span>()<span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>key, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>)
</code></pre></div><p><img src="http://sebastiansauer.github.io/images/2016-11-19/unnamed-chunk-17-1.png" alt="plot of chunk unnamed-chunk-17"></p>
<p>Appears ok!</p>
<p>Ok, let&rsquo;s save the data file as the last step (here, we simple chose the working directory)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">write.csv</span>(data, file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;extra.csv&#34;</span>)
</code></pre></div>
    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//https-data-se-netlify-com.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

