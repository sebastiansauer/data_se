<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.74.3" />


<title>Plotting survey results using `ggplot2` - Data Se</title>
<meta property="og:title" content="Plotting survey results using `ggplot2` - Data Se">



  








<link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo-data-se.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="/">Blog</a></li>
    
    <li><a href="/privacy/">Data privacy</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">11 min read</span>
    

    <h1 class="article-title">Plotting survey results using `ggplot2`</h1>

    
    <span class="article-date">2016/11/12</span>
    

    <div class="article-content">
      <p>Plotting (and more generally, analyzing) survey results is a frequent endeavor in many business environments. Let&rsquo;s not think about arguments whether and when surveys are useful (for some recent criticism see <a href="http://www.springer.com/de/book/9783319397559">Briggs&rsquo; book</a>).</p>
<p>Typically, respondents circle some option ranging from &ldquo;don&rsquo;t agree at all&rdquo; to &ldquo;completely agree&rdquo; for each question (or &ldquo;item&rdquo;). Typically, four to six boxes are given where one is expected to tick one.</p>
<p>In this tutorial, I will discuss some barplot type visualizations; the presentation is based on <code>ggplot2</code> (within the <code>R</code> environment) . Sure, much more can be done than will be presented here, but for the scope of this post, we will stick to the plain barplot (although some variations of it).</p>
<p>Let&rsquo;s load some needed packages:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(tidyverse)
</code></pre></div><hr>
<p>EDIT: The preparation part of this post has been <em>excluded</em> and moved to an <a href="https://sebastiansauer.github.io/preparing_survey_data/">own post</a>, for clarity.</p>
<hr>
<h1 id="loading-data">Loading data</h1>
<p>So, first, let&rsquo;s load some data. That&rsquo;s a data set of a survey on extraversion. Folks were asked a bunch of questions tapping at their &ldquo;psychometric extraversion&rdquo;, and some related behavior, that is, behavior <em>supposed to</em> be related such as &ldquo;number of Facebook friends&rdquo;, &ldquo;how often at a party&rdquo; etc. Note that college students form the sample.</p>
<p>Data are available only (free as in free and free as in beer).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;https://osf.io/meyhp/?action=download&#34;</span>)


data_backup <span style="color:#f92672">&lt;-</span> data <span style="color:#75715e"># backup just in case we screw something up</span>
</code></pre></div><p>Here&rsquo;s the DOI of this piece of data: 10.17605/OSF.IO/4KGZH.</p>
<p>OK, we got &lsquo;em; a dataset of dimension 501, 28. Let&rsquo;s glimpse at the data:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">glimpse</span>(data)
</code></pre></div><pre><code>## Observations: 501
## Variables: 28
## $ X                  &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, ...
## $ timestamp          &lt;fctr&gt; 11.03.2015 19:17:48, 11.03.2015 19:18:05, ...
## $ code               &lt;fctr&gt; HSC, ERB, ADP, KHB, PTG, ABL, ber, hph, IH...
## $ i01                &lt;int&gt; 3, 2, 3, 3, 4, 3, 4, 3, 4, 4, 3, 3, 4, 4, 3...
## $ i02r               &lt;int&gt; 3, 2, 4, 3, 3, 2, 4, 3, 4, 4, 3, 4, 3, 3, 3...
## $ i03                &lt;int&gt; 3, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 4, 1...
## $ i04                &lt;int&gt; 3, 2, 4, 4, 4, 4, 3, 3, 4, 4, 3, 3, 2, 4, 3...
## $ i05                &lt;int&gt; 4, 3, 4, 3, 4, 2, 3, 2, 3, 3, 3, 2, 3, 3, 3...
## $ i06r               &lt;int&gt; 4, 2, 1, 3, 3, 3, 3, 2, 4, 3, 3, 3, 3, 3, 3...
## $ i07                &lt;int&gt; 3, 2, 3, 3, 4, 4, 2, 3, 3, 3, 2, 4, 2, 3, 3...
## $ i08                &lt;int&gt; 2, 3, 2, 3, 2, 3, 3, 2, 3, 3, 3, 2, 3, 3, 4...
## $ i09                &lt;int&gt; 3, 3, 3, 3, 3, 3, 3, 4, 4, 3, 4, 2, 4, 4, 4...
## $ i10                &lt;int&gt; 1, 1, 1, 2, 4, 3, 2, 1, 2, 3, 1, 3, 2, 3, 2...
## $ n_facebook_friends &lt;int&gt; 250, 106, 215, 200, 100, 376, 180, 432, 200...
## $ n_hangover         &lt;int&gt; 1, 0, 0, 15, 0, 1, 1, 2, 5, 0, 1, 2, 20, 2,...
## $ age                &lt;int&gt; 24, 35, 25, 39, 29, 33, 24, 28, 29, 38, 25,...
## $ sex                &lt;fctr&gt; Frau, Frau, Frau, Frau, Frau, Mann, Frau, ...
## $ extra_single_item  &lt;int&gt; 4, 3, 4, 3, 4, 4, 3, 3, 4, 4, 4, 4, 4, 4, 4...
## $ time_conversation  &lt;dbl&gt; 10, 15, 15, 5, 5, 20, 2, 15, 10, 10, 1, 5, ...
## $ presentation       &lt;fctr&gt; nein, nein, nein, nein, nein, ja, ja, ja, ...
## $ n_party            &lt;int&gt; 20, 5, 3, 25, 4, 4, 3, 6, 12, 5, 10, 5, 10,...
## $ clients            &lt;fctr&gt; , , , , , , , , , , , , , , , , , , , , , ...
## $ extra_vignette     &lt;fctr&gt; , , , , , , , , , , , , , , , , , , , , , ...
## $ extra_description  &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
## $ prop_na_per_row    &lt;dbl&gt; 0.04347826, 0.04347826, 0.04347826, 0.04347...
## $ extra_mean         &lt;dbl&gt; 2.9, 2.1, 2.6, 2.9, 3.2, 2.8, 2.8, 2.5, 3.2...
## $ extra_median       &lt;dbl&gt; 3.0, 2.0, 3.0, 3.0, 3.5, 3.0, 3.0, 2.5, 3.5...
## $ client_freq        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,...
</code></pre><p>Let&rsquo;s extract only the items, and exclude <code>NA</code>s (there are not many).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span> nrow
</code></pre></div><pre><code>## [1] 501
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span>
  na.omit <span style="color:#f92672">%&gt;%</span> nrow
</code></pre></div><pre><code>## [1] 493
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(i01<span style="color:#f92672">:</span>i10) <span style="color:#f92672">%&gt;%</span>
  na.omit <span style="color:#f92672">-&gt;</span> data_items
</code></pre></div><h1 id="plotting-item-distribution">Plotting item distribution</h1>
<h2 id="typical-stacked-bar-plot">Typical stacked bar plot</h2>
<p>The most obvious thing is to plot the distribution of the items (here: 10) of the survey. So let&rsquo;s do that with <code>ggplot</code>.</p>
<p>On the x-axis we would like to have each item (i1, i2, &hellip;), and on the y-axis the frequency of each answer, in some stapled bar fashion. That means, on the x-axis is <em>one</em> variable only. That&rsquo;s why we need to &ldquo;melt&rdquo; the items to one &ldquo;long&rdquo; variable.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data_items <span style="color:#f92672">%&gt;%</span>  
  <span style="color:#a6e22e">gather</span>(key <span style="color:#f92672">=</span> items, value <span style="color:#f92672">=</span> answer) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(answer <span style="color:#f92672">=</span> <span style="color:#a6e22e">factor</span>(answer)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_bar</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> answer), position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;fill&#34;</span>) <span style="color:#f92672">-&gt;</span> p1
p1
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4"></p>
<p>Maybe nicer to turn it 90 degrees:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p1 <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>()
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-5-1.png" alt="plot of chunk unnamed-chunk-5"></p>
<p>And reverse the order of the items, so that <code>i01</code> is at the top.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data_items <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">gather</span>(key <span style="color:#f92672">=</span> items, value <span style="color:#f92672">=</span> answer) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(answer <span style="color:#f92672">=</span> <span style="color:#a6e22e">factor</span>(answer),
         items <span style="color:#f92672">=</span> <span style="color:#a6e22e">factor</span>(items)) <span style="color:#f92672">-&gt;</span> data2
  
<span style="color:#a6e22e">ggplot</span>(data2, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_bar</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> answer), position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;fill&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_x_discrete</span>(limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">rev</span>(<span style="color:#a6e22e">levels</span>(data2<span style="color:#f92672">$</span>items))) <span style="color:#f92672">-&gt;</span> p2
p2
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6"></p>
<h2 id="colors">Colors</h2>
<p>The beauty of the colors lie in the eye of the beholder&hellip; Let&rsquo;s try a different palette.</p>
<p>Sequential color palettes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Blues&#34;</span>)
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BuGn&#34;</span>)
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-7-2.png" alt="plot of chunk unnamed-chunk-7"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>)
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-7-3.png" alt="plot of chunk unnamed-chunk-7"></p>
<p>Diverging palettes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;RdYlGn&#34;</span>)
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_fill_brewer</span>(palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;RdYlBu&#34;</span>)
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-8-2.png" alt="plot of chunk unnamed-chunk-8"></p>
<p>The divering palettes are useful because we have two &ldquo;poles&rdquo; - &ldquo;do not agree&rdquo; on one side, and &ldquo;do agree&rdquo; on the other side.</p>
<p>See <a href="https://www.r-bloggers.com/choosing-colour-palettes-part-ii-educated-choices/">here</a> for an overview on Brewer palettes.</p>
<p>Or maybe just grey tones.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_fill_grey</span>()
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-9-1.png" alt="plot of chunk unnamed-chunk-9"></p>
<p>My own favorite-cherished color.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">colours <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;#2121D9&#34;</span>, <span style="color:#e6db74">&#34;#9999FF&#34;</span>, <span style="color:#e6db74">&#34;#D92121&#34;</span>, <span style="color:#e6db74">&#34;#21D921&#34;</span>, <span style="color:#e6db74">&#34;#FFFF4D&#34;</span>, <span style="color:#e6db74">&#34;#FF9326&#34;</span>)
p2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_fill_manual</span>(values<span style="color:#f92672">=</span>colours)
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-10-1.png" alt="plot of chunk unnamed-chunk-10"></p>
<h2 id="numbers-count-on-bars">Numbers (count) on bars</h2>
<p>It might be helpful to print the exact numbers on the bars.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data2 <span style="color:#f92672">%&gt;%</span> 
  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">count</span>(items, answer) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(y_pos <span style="color:#f92672">=</span> <span style="color:#a6e22e">cumsum</span>(n)<span style="color:#f92672">/</span><span style="color:#a6e22e">nrow</span>(data_items) <span style="color:#f92672">-</span> (<span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> n<span style="color:#f92672">/</span><span style="color:#a6e22e">nrow</span>(data_items)),
         y_cumsum <span style="color:#f92672">=</span> <span style="color:#a6e22e">cumsum</span>(n)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(items_num <span style="color:#f92672">=</span> <span style="color:#a6e22e">parse_number</span>(items)) <span style="color:#f92672">-&gt;</span> data3

<span style="color:#a6e22e">ggplot</span>(data3, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, y <span style="color:#f92672">=</span> n)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_bar</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> answer), position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;fill&#34;</span>, stat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;identity&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> y_pos, label <span style="color:#f92672">=</span> n),  size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">-&gt;</span> p3

p3
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-11-1.png" alt="plot of chunk unnamed-chunk-11"></p>
<p>Flip coordinate system, and with &ldquo;%&rdquo; labels.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p3 <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_y_continuous</span>(labels <span style="color:#f92672">=</span> scales<span style="color:#f92672">::</span>percent) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;proportion of respondents&#34;</span>) <span style="color:#f92672">-&gt;</span> p4
p4
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-12-1.png" alt="plot of chunk unnamed-chunk-12"></p>
<h2 id="highlight-main-category">Highlight main category</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data3 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(answer <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.numeric</span>(answer)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(items) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(max_n <span style="color:#f92672">=</span> <span style="color:#a6e22e">max</span>(n)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(max_cat <span style="color:#f92672">=</span> <span style="color:#a6e22e">factor</span>(<span style="color:#a6e22e">which</span>(n <span style="color:#f92672">==</span> max_n))) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(fit_cat <span style="color:#f92672">=</span> (answer <span style="color:#f92672">==</span> max_cat)) <span style="color:#f92672">%&gt;%</span> 
  ungroup <span style="color:#f92672">-&gt;</span> data4


<span style="color:#a6e22e">ggplot</span>(data4, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, y <span style="color:#f92672">=</span> n)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_bar</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> <span style="color:#a6e22e">factor</span>(answer),
               color <span style="color:#f92672">=</span> fit_cat), position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;fill&#34;</span>, stat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;identity&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> y_pos, label <span style="color:#f92672">=</span> n),  size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_color_manual</span>(values <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;NA&#34;</span>, <span style="color:#e6db74">&#34;red&#34;</span>), guide <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_fill_grey</span>()
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-13-1.png" alt="plot of chunk unnamed-chunk-13"></p>
<p>To be honest, does really look nice. Let&rsquo;s try something different later.</p>
<h2 id="barplot-with-geom_rect">Barplot with <code>geom_rect</code></h2>
<p>This section and code is inspired by <a href="http://rnotr.com/likert/ggplot/barometer/likert-plotly/">this post</a>.</p>
<p>The goal is to produce a more flexible bar plot, such as a &ldquo;waterfall plot&rdquo;, where y= 0 is centered at the middle bar height, we need to change the <code>geom</code>. No more <code>geom_bar</code> but the more versatile <code>geom_rect</code>. This geom plots, surprisingly, rectangles. Hence, we need to know the start and the end value (for the y-axis, the width of the bar is just 1).</p>
<p>First, we need to prepare the dataset for that task.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data4 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(items, answer, y_cumsum) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(items) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">spread</span>(key <span style="color:#f92672">=</span> answer, value <span style="color:#f92672">=</span> y_cumsum) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(zero <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, end <span style="color:#f92672">=</span> <span style="color:#a6e22e">nrow</span>(data_items)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(items, zero, `1`, `2`, `3`, `4`, end) <span style="color:#f92672">%&gt;%</span> 
  ungroup <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(items_num <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) <span style="color:#f92672">-&gt;</span> data5



data5 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(start_1 <span style="color:#f92672">=</span> zero) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(end_1 <span style="color:#f92672">=</span> `1`) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(start_2 <span style="color:#f92672">=</span> `1`) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(end_2 <span style="color:#f92672">=</span> `2`) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(start_3 <span style="color:#f92672">=</span> `2`) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(end_3 <span style="color:#f92672">=</span> `3`) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(start_4 <span style="color:#f92672">=</span> `3`) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(end_4 <span style="color:#f92672">=</span> end) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(items_num, start_1, end_1, start_2, end_2, start_3, end_3, start_4, end_4) <span style="color:#f92672">-&gt;</span> data6

<span style="color:#a6e22e">head</span>(data6) <span style="color:#f92672">%&gt;%</span> kable
</code></pre></div><table>
<thead>
<tr>
<th align="right">items_num</th>
<th align="right">start_1</th>
<th align="right">end_1</th>
<th align="right">start_2</th>
<th align="right">end_2</th>
<th align="right">start_3</th>
<th align="right">end_3</th>
<th align="right">start_4</th>
<th align="right">end_4</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">46</td>
<td align="right">46</td>
<td align="right">273</td>
<td align="right">273</td>
<td align="right">493</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">97</td>
<td align="right">97</td>
<td align="right">318</td>
<td align="right">318</td>
<td align="right">493</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">203</td>
<td align="right">203</td>
<td align="right">366</td>
<td align="right">366</td>
<td align="right">461</td>
<td align="right">461</td>
<td align="right">493</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">79</td>
<td align="right">79</td>
<td align="right">290</td>
<td align="right">290</td>
<td align="right">493</td>
</tr>
<tr>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">11</td>
<td align="right">110</td>
<td align="right">110</td>
<td align="right">344</td>
<td align="right">344</td>
<td align="right">493</td>
</tr>
<tr>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">114</td>
<td align="right">114</td>
<td align="right">383</td>
<td align="right">383</td>
<td align="right">493</td>
</tr>
</tbody>
</table>
<p>OK, we have that, pooh, quite a mess.</p>
<p>So, now we need it in long form. Here come a not so elegant, but rather simple, solution for that.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data_cat1 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data6, items_num, start_1, end_1) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">setNames</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;items&#34;</span>, <span style="color:#e6db74">&#34;start&#34;</span>, <span style="color:#e6db74">&#34;end&#34;</span>)) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(answer <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
data_cat2 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data6, items_num, start_2, end_2) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">setNames</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;items&#34;</span>,<span style="color:#e6db74">&#34;start&#34;</span>, <span style="color:#e6db74">&#34;end&#34;</span>))  <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(answer <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>)
data_cat3 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data6, items_num, start_3, end_3) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">setNames</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;items&#34;</span>,<span style="color:#e6db74">&#34;start&#34;</span>, <span style="color:#e6db74">&#34;end&#34;</span>))  <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(answer <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
data_cat4 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data6, items_num, start_4, end_4) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">setNames</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;items&#34;</span>,<span style="color:#e6db74">&#34;start&#34;</span>, <span style="color:#e6db74">&#34;end&#34;</span>))  <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">mutate</span>(answer <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>)

   
data7 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_rows</span>(data_cat1, data_cat2, data_cat3, data_cat4) 

data7 <span style="color:#f92672">%&gt;%</span> head <span style="color:#f92672">%&gt;%</span> kable
</code></pre></div><table>
<thead>
<tr>
<th align="right">items</th>
<th align="right">start</th>
<th align="right">end</th>
<th align="right">answer</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">203</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">1</td>
</tr>
<tr>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">23</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Now let&rsquo;s plot the bar graph with the rectangle plot.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data7<span style="color:#f92672">$</span>answer <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">factor</span>(data7<span style="color:#f92672">$</span>answer)

<span style="color:#a6e22e">ggplot</span>(data7) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">aes</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_rect</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, 
                ymin <span style="color:#f92672">=</span> start, 
                ymax <span style="color:#f92672">=</span> end, 
                xmin <span style="color:#f92672">=</span> items <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.4</span>, 
                xmax <span style="color:#f92672">=</span> items <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.4</span>,
                fill <span style="color:#f92672">=</span> answer)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_x_continuous</span>(breaks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;items&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;n&#34;</span>) <span style="color:#f92672">-&gt;</span> p5
</code></pre></div><pre><code>## Warning: Ignoring unknown aesthetics: x
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p5 <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> data3, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items_num, y <span style="color:#f92672">=</span> y_pos<span style="color:#f92672">*</span><span style="color:#a6e22e">nrow</span>(data), label <span style="color:#f92672">=</span> n), size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">-&gt;</span> p6

p6
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-16-1.png" alt="plot of chunk unnamed-chunk-16"></p>
<p>Compare that to the <code>geom_bar</code> solution.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p3
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-17-1.png" alt="plot of chunk unnamed-chunk-17"></p>
<p>Basically identical (never mind the bar width).</p>
<p>Now flip the coordinates again (and compare to previous solution with <code>geom_bar</code>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p6 <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>()
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-18-1.png" alt="plot of chunk unnamed-chunk-18"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p4
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-18-2.png" alt="plot of chunk unnamed-chunk-18"></p>
<p>Let&rsquo;s try to highlight the most frequent answer category for each item.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data7 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(n <span style="color:#f92672">=</span> end <span style="color:#f92672">-</span> start) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(items) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(max_n <span style="color:#f92672">=</span> <span style="color:#a6e22e">max</span>(n)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(max_cat <span style="color:#f92672">=</span> <span style="color:#a6e22e">factor</span>(<span style="color:#a6e22e">which</span>(n <span style="color:#f92672">==</span> max_n))) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(fit_cat <span style="color:#f92672">=</span> (answer <span style="color:#f92672">==</span> max_cat)) <span style="color:#f92672">%&gt;%</span> 
  ungroup <span style="color:#f92672">-&gt;</span> data8

data8 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(fit_cat <span style="color:#f92672">==</span> <span style="color:#66d9ef">TRUE</span>) <span style="color:#f92672">-&gt;</span> data8a


data7 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">aes</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_rect</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, 
                ymin <span style="color:#f92672">=</span> start, 
                ymax <span style="color:#f92672">=</span> end, 
                xmin <span style="color:#f92672">=</span> items <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.4</span>, 
                xmax <span style="color:#f92672">=</span> items <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.4</span>,
                fill <span style="color:#f92672">=</span> answer)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_x_continuous</span>(breaks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;items&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;n&#34;</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_fill_grey</span>(start <span style="color:#f92672">=</span> <span style="color:#ae81ff">.4</span>, end <span style="color:#f92672">=</span> <span style="color:#ae81ff">.8</span>) <span style="color:#f92672">-&gt;</span> p8
</code></pre></div><pre><code>## Warning: Ignoring unknown aesthetics: x
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p8 <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_rect</span>(data <span style="color:#f92672">=</span> data8a, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, 
                ymin <span style="color:#f92672">=</span> start, 
                ymax <span style="color:#f92672">=</span> end, 
                xmin <span style="color:#f92672">=</span> items <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.4</span>, 
                xmax <span style="color:#f92672">=</span> items <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.4</span>), fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>)  <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> data3, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items_num, y <span style="color:#f92672">=</span> y_pos<span style="color:#f92672">*</span><span style="color:#a6e22e">nrow</span>(data), label <span style="color:#f92672">=</span> n), size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">-&gt;</span> p8
</code></pre></div><pre><code>## Warning: Ignoring unknown aesthetics: x
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p8 <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>()
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-19-1.png" alt="plot of chunk unnamed-chunk-19"></p>
<p><a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">Here&rsquo;s</a> a cheat sheet on colors and palettes; and <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">here</a> you&rsquo;ll find an overview on colors (with names and hex codes).</p>
<p>Mrs. Brewer <a href="http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">site</a> is a great place to come up with your own palette and learn more about colors.</p>
<h1 id="rainbow-diagram">Rainbow diagram</h1>
<p>Let&rsquo;s try to &ldquo;move&rdquo; the bars to our wishes. Precisely, it would be nice if the bars were aligned at the &ldquo;Rubicon&rdquo; between &ldquo;do <em>not</em> agree&rdquo; and &ldquo;<em>do</em> agree&rdquo;. Then we could see better how many persons agree and not.</p>
<p>More practically, if we knew that 104+212 = 316 persons basically disagree, then 316 could be our &ldquo;zero line&rdquo; (item 10). Repeat that for each item.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data8 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(items) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(n_disagree <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(n<span style="color:#a6e22e">[c</span>(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>)]),
         n_agree <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(n<span style="color:#a6e22e">[c</span>(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>)]),
         start_adj <span style="color:#f92672">=</span> start <span style="color:#f92672">-</span> n_disagree,
         end_adj <span style="color:#f92672">=</span> end <span style="color:#f92672">-</span> n_disagree
         ) <span style="color:#f92672">%&gt;%</span> 
  ungroup <span style="color:#f92672">-&gt;</span> data9


data9 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">aes</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_rect</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, 
                ymin <span style="color:#f92672">=</span> start_adj, 
                ymax <span style="color:#f92672">=</span> end_adj, 
                xmin <span style="color:#f92672">=</span> items <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.4</span>, 
                xmax <span style="color:#f92672">=</span> items <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.4</span>,
                fill <span style="color:#f92672">=</span> answer)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_x_continuous</span>(breaks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;items&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;n&#34;</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">scale_fill_grey</span>(start <span style="color:#f92672">=</span> <span style="color:#ae81ff">.4</span>, end <span style="color:#f92672">=</span> <span style="color:#ae81ff">.8</span>) <span style="color:#f92672">-&gt;</span> p9
</code></pre></div><pre><code>## Warning: Ignoring unknown aesthetics: x
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p9
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-20-1.png" alt="plot of chunk unnamed-chunk-20"></p>
<p>Looks quite cool.</p>
<p>Now let&rsquo;s add the numbers to that plot.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">data4 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(items_num <span style="color:#f92672">=</span> <span style="color:#a6e22e">parse_number</span>(items)) <span style="color:#f92672">%&gt;%</span> 
  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span>items) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(items <span style="color:#f92672">=</span> items_num) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(items, <span style="color:#a6e22e">everything</span>()) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">arrange</span>(answer, items) <span style="color:#f92672">%&gt;%</span> 
  ungroup <span style="color:#f92672">-&gt;</span> data10


data9 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(y_pos_adj <span style="color:#f92672">=</span> data10<span style="color:#f92672">$</span>y_pos <span style="color:#f92672">*</span> <span style="color:#a6e22e">nrow</span>(data) <span style="color:#f92672">-</span> n_disagree) <span style="color:#f92672">-&gt;</span> data11



p9 <span style="color:#f92672">+</span>  
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> data11, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, y <span style="color:#f92672">=</span> y_pos_adj, label <span style="color:#f92672">=</span> n), size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">-&gt;</span> p11

p11
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-21-1.png" alt="plot of chunk unnamed-chunk-21"></p>
<p>And now let&rsquo;s highlight the most frequent answer category.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(ggrepel)

data11 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">aes</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_rect</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items,
                ymin <span style="color:#f92672">=</span> start_adj,
                ymax <span style="color:#f92672">=</span> end_adj,
                xmin <span style="color:#f92672">=</span> items <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.4</span>,
                xmax <span style="color:#f92672">=</span> items <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.4</span>,
                fill <span style="color:#f92672">=</span> answer)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_fill_grey</span>(start <span style="color:#f92672">=</span> <span style="color:#ae81ff">.4</span>, end <span style="color:#f92672">=</span> <span style="color:#ae81ff">.8</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">geom_rect</span>(data <span style="color:#f92672">=</span> <span style="color:#a6e22e">filter</span>(data11, fit_cat <span style="color:#f92672">==</span> <span style="color:#66d9ef">TRUE</span>), 
            <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, 
                ymin <span style="color:#f92672">=</span> start_adj, 
                ymax <span style="color:#f92672">=</span> end_adj, 
                xmin <span style="color:#f92672">=</span> items <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.4</span>, 
                xmax <span style="color:#f92672">=</span> items <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.4</span>),
            fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;red&#34;</span>) <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">geom_text</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> items, y <span style="color:#f92672">=</span> y_pos_adj, label <span style="color:#f92672">=</span> n), size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_x_continuous</span>(breaks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">ylab</span>(<span style="color:#e6db74">&#34;n&#34;</span>) <span style="color:#f92672">-&gt;</span> p12
</code></pre></div><pre><code>## Warning: Ignoring unknown aesthetics: x

## Warning: Ignoring unknown aesthetics: x
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p12
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-22-1.png" alt="plot of chunk unnamed-chunk-22"></p>
<p>OK, that&rsquo;s about it for today. May turn the waterfall by 90°.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p12 <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>()
</code></pre></div><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-23-1.png" alt="plot of chunk unnamed-chunk-23"></p>
<p>And change the direction of the now numeric items-axis.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">p12 <span style="color:#f92672">+</span> <span style="color:#a6e22e">coord_flip</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">scale_x_reverse</span>(breaks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>)
</code></pre></div><pre><code>## Scale for 'x' is already present. Adding another scale for 'x', which
## will replace the existing scale.
</code></pre><p><img src="https://sebastiansauer.github.io/images/2016-11-12/unnamed-chunk-24-1.png" alt="plot of chunk unnamed-chunk-24"></p>
<p>Happy plotting!</p>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//https-data-se-netlify-com.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

