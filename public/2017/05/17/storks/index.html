<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.21" />


<title>A predictor&#39;s unique contribution - (visual) demonstration - Data Se</title>
<meta property="og:title" content="A predictor&#39;s unique contribution - (visual) demonstration - Data Se">



  








<link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo-data-se.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="/">Blog</a></li>
    
    <li><a href="/tags/">Tags</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">6 min read</span>
    

    <h1 class="article-title">A predictor&#39;s unique contribution - (visual) demonstration</h1>

    
    <span class="article-date">2017/05/17</span>
    

    <div class="article-content">
      

<p>A well-known property of regression models is that they capture the <em>unique</em> contribution of a predictor. By &ldquo;unique&rdquo; we mean the effect of the predictor (on the criterion) <em>if the other predictor(s) is/are held constant</em>. A typical classroom example goes along the following lines.</p>

<h1 id="all-about-storks">All about storks</h1>

<ol>
<li><p>There&rsquo;s a correlation between babies and storks. Counties with lots of storks enjoy large number of babies and v.v.</p></li>

<li><p>However, I have children, I know the storks are not overly involved in that business, so says the teacher (polite laughters in the audience).</p></li>

<li><p>Once we consider a third variable, call it nature-level, we see that the correlation between storks and babies vanishes.</p></li>

<li><p>Assume that nature-level and storks are correlated - in nature-rich areas there are a lot of storks. Assume further that nature-level and the amount of babies are correlated - in nature-rich areas people have relatively many babies.</p></li>

<li><p>That&rsquo;s why we find a correlation between babies and storks (&ldquo;spurious&rdquo; it is called), which is (fully) attributable to the nature-level.</p></li>
</ol>

<p>This is all well-known but it helps to see it in real data. That&rsquo;s the objective of this post.</p>

<h1 id="tip-sex-and-total-bill-two-simple-bivariate-analyses">Tip, sex, and total_bill - two simple bivariate analyses</h1>

<p>Let&rsquo;s have a look at the tips dataset.</p>

<pre><code class="language-r">data(tips, package = &quot;reshape2&quot;)
</code></pre>

<p>And load some datajudo packages.</p>

<pre><code class="language-r">library(tidyverse)
</code></pre>

<p>First, simple bivariate assocations for sex-tip and total_bill-tip.</p>

<p>Is there an assocation between sex and tip?</p>

<pre><code class="language-r">ggplot(tips) +
  ggplot2::aes(x = sex, y = tip) +
  geom_jitter(color = &quot;grey80&quot;) +
  geom_jitter(data = tips, aes(color = sex)) +
  stat_summary(fun.y = mean, color = &quot;red&quot;, geom = &quot;line&quot;, size = 2, group = 1) +
  stat_summary(fun.y = mean, color = &quot;red&quot;, geom = &quot;point&quot;, size = 5, group = 1, alpha = .5)
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" width="80%" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tips2 &lt;- select(tips, -sex)

tips %&gt;% 
  ggplot() +
  aes(x = total_bill, y = tip) +
  geom_point(data = tips2, color = &quot;grey80&quot;) +
  geom_point(aes(color = sex)) +
  facet_wrap(~sex)
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-3-2.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" width="80%" style="display: block; margin: auto;" /></p>

<p>It appears that men do tip slightly more than women do.</p>

<pre><code class="language-r">tips %&gt;% 
  group_by(sex) %&gt;% 
  summarise(tip_sex_mean = mean(tip),
            tip_sex_md = median(tip))
</code></pre>

<pre><code>## # A tibble: 2 x 3
##      sex tip_sex_mean tip_sex_md
##   &lt;fctr&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1 Female     2.833448       2.75
## 2   Male     3.089618       3.00
</code></pre>

<p>Ok, some 25 Cent difference, in favor of men. Some association is present in the data.</p>

<p>Let&rsquo;s run a regression on that, just to double-check.</p>

<pre><code class="language-r">lm(tip ~ sex,
   data = tips)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = tip ~ sex, data = tips)
## 
## Coefficients:
## (Intercept)      sexMale  
##      2.8334       0.2562
</code></pre>

<p>Ok, confirmed.</p>

<p>Now, what about the association of total_bill and tip?</p>

<pre><code class="language-r">tips %&gt;% 
  ggplot +
  aes(x = total_bill, y = tip) +
  geom_point()
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-6-1.png" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" width="80%" style="display: block; margin: auto;" /></p>

<p>Oh, clearly, some correlation is present between total_bill and tip.</p>

<pre><code class="language-r">tips %&gt;% 
  summarise(cor_tip_bill = cor(tip, total_bill))
</code></pre>

<pre><code>##   cor_tip_bill
## 1    0.6757341
</code></pre>

<p>And let&rsquo;s have a look at the slope of the regression.</p>

<pre><code class="language-r">lm(tip ~ total_bill, data = tips)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = tip ~ total_bill, data = tips)
## 
## Coefficients:
## (Intercept)   total_bill  
##      0.9203       0.1050
</code></pre>

<h1 id="multivariate-analysis">Multivariate analysis</h1>

<p>Now let&rsquo;s do that in one run:</p>

<pre><code class="language-r">lm(tip ~ total_bill + sex,
   data = tips)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = tip ~ total_bill + sex, data = tips)
## 
## Coefficients:
## (Intercept)   total_bill      sexMale  
##     0.93328      0.10523     -0.02661
</code></pre>

<p>Notice that the slope of the predictor <code>total_bill</code> has not changed much. But <code>sex</code> did!</p>

<p>So, the <em>unique</em> contribution of sex is very small, about 2 Cent, and in favor of <em>women</em> when considered in junction with total_bill!</p>

<h1 id="let-s-visualize-the-multivariate-appraoch">Let&rsquo;s visualize the multivariate appraoch</h1>

<p>First, for easier visualization, let&rsquo;s bin <code>total_bill</code> in say, 5, bins.</p>

<pre><code class="language-r">tips$bill_bins &lt;- cut_interval(tips$total_bill, n = 5)
</code></pre>

<p>Now let&rsquo;s plot all three variables in one go.</p>

<pre><code class="language-r">tips %&gt;% 
  ggplot +
  aes(x = bill_bins, 
      y = tip,
      fill = sex) +
  geom_boxplot() +
  geom_point(alpha = .5)
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-11-1.png" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="80%" style="display: block; margin: auto;" /></p>

<p>We see that <em>females</em> do tip <em>more</em> than men when the 5 bins of <code>total_bill</code> are considered each in isolation. For 4 of the 5 bins we find that the median of the women is higher than that of the men. Only in the 5th, ie., highest bin, we found that men tip higher. However, this bin is slightly populated, so we may negligate it. In sum, looking at each bin of <code>total_bill</code> - women tip more than men do!</p>

<p>Depicted differently:</p>

<pre><code class="language-r">tips %&gt;% 
  ggplot() +
  aes(x = total_bill, y = tip) +
  geom_point(data = tips2, color = &quot;grey80&quot;) +
  geom_point(aes(color = sex)) +
  facet_wrap(~sex)
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-12-1.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" width="80%" style="display: block; margin: auto;" /></p>

<h1 id="dichotomize-total-bill">Dichotomize total_bill</h1>

<p>Maybe even more vivid is we we do not bin total_bill in 5 bins, but just in two.</p>

<pre><code class="language-r">tips$bill_bins &lt;- cut_interval(tips$total_bill, n = 2)
</code></pre>

<p>Again, let&rsquo;s plot the three variables.</p>

<pre><code class="language-r">tips %&gt;% 
  ggplot +
  aes(x = bill_bins, 
      y = tip,
      fill = sex) +
  geom_boxplot() +
  geom_point(alpha = .5)
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-14-1.png" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" width="80%" style="display: block; margin: auto;" /></p>

<p>We find that women seem to tip slightly more than men do; at least not less.</p>

<h1 id="a-simpson-case">A Simpson case</h1>

<p>What happens can be considered a Simpson&rsquo;s paradox, based on the fact that men spend more than women do (higher <code>total_bill</code>). Even though they <em>tip</em> less or equally to women it appears they tip &ldquo;in sum&rdquo; (not considering <code>total_bill</code>) more simply because <code>total_bill</code> and <code>tip</code> are related.</p>

<p>Let&rsquo;s dichotomize total_bill and see which sex group (females or males) occur more frequently.</p>

<pre><code class="language-r">tips %&gt;% 
  mutate(bill_di = ntile(total_bill, n = 2),
         bill_di_f = if_else(bill_di == 1, &quot;low&quot;, &quot;hi&quot;)) %&gt;% 
  count(sex, bill_di_f) %&gt;% 
 # gather(bill_group, n, -n) %&gt;% 
  ggplot() +
  aes(x = sex, fill = bill_di_f, y = n) +
  geom_col(position = &quot;fill&quot;)
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-15-1.png" title="plot of chunk unnamed-chunk-15" alt="plot of chunk unnamed-chunk-15" width="80%" style="display: block; margin: auto;" /></p>

<p>We see that the in the male group, high values occurr more frequently.</p>

<h1 id="path-model">Path model</h1>

<p><code>sex_male</code> has a positive effect on <code>total_bill</code>; and <code>total_bill</code> in turn on <code>tip</code>.
But <code>sex_male</code> does <em>not</em> exert much of an influence on <code>tip</code> anymore, after controling for <code>total_bill</code> (in fact, the positive effect turned to a weak <em>negative</em> impact).</p>

<pre><code class="language-r">library(DiagrammeR)
mermaid(&quot;
graph LR
  total_bill--&gt;tip
  sex_male--&gt;total_bill
  sex_male---tip
 &quot;)
</code></pre>

<p><img src="https://sebastiansauer.github.io/images/2017-05-17/figure/unnamed-chunk-16-1.png" title="plot of chunk unnamed-chunk-16" alt="plot of chunk unnamed-chunk-16" width="80%" style="display: block; margin: auto;" /></p>

<h1 id="conclusion">Conclusion</h1>

<p>That kind of &ldquo;swapping&rdquo; of the regression coefficient is a frequent observation in (multiple) regression. We may conclude that the multivariate analyses with 3 variables is <em>more</em> adequate than the bivariate analyses with one predictor only.</p>

<p>However, a caveat is that we can never be sure that this swapping process is now complete. Maybe we are missing out some more variable that will again make the coefficients swap. Alas, this we cannot know in observational reseach. That&rsquo;s why observational data should not be overinterpreted.</p>

<p>Of course, even if commonly speak of &ldquo;effects&rdquo; this language should never be taken as indicative of causal effects. Causal effects is nothing that can firmly be established by statistics. Causality claims rest of more logical and substantive argument.</p>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//https-sebastiansauer-github-io.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-99297878-1', 'auto');
ga('send', 'pageview');
</script>

  </body>
</html>

