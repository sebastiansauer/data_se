<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.78.2" />


<title>Performance measures for `caret` and `lm()` - Data Se</title>
<meta property="og:title" content="Performance measures for `caret` and `lm()` - Data Se">



  








<link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo-data-se.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="/">Blog</a></li>
    
    <li><a href="/privacy/">Data privacy</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">31 min read</span>
    

    <h1 class="article-title">Performance measures for `caret` and `lm()`</h1>

    
    <span class="article-date">2019/08/02</span>
    

    <div class="article-content">
      


<p>Recently, I run into performance issue when fitting a linear model together with a resampling scheme and a tuning grid (via caret). The dataset was recently large - some 200k rows and approx. 20 columns (<code>nycflights13</code> train). Still, I was suprised that my machine got stuck during the computation. Now I wonder whether I ran into memory constraints (16BG on my machine), or whether some other stuff went wrong.</p>
<div id="load-packages" class="section level1">
<h1>Load packages</h1>
<pre class="r"><code>library(tidyverse)
library(caret)
library(stringr)</code></pre>
</div>
<div id="load-data" class="section level1">
<h1>Load data</h1>
<pre class="r"><code>data(&quot;flights&quot;, package = &quot;nycflights13&quot;)
glimpse(flights)
#&gt; Observations: 336,776
#&gt; Variables: 19
#&gt; $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2…
#&gt; $ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
#&gt; $ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
#&gt; $ dep_time       &lt;int&gt; 517, 533, 542, 544, 554, 554, 555, 557, 557, 558,…
#&gt; $ sched_dep_time &lt;int&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600,…
#&gt; $ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, …
#&gt; $ arr_time       &lt;int&gt; 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753…
#&gt; $ sched_arr_time &lt;int&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745…
#&gt; $ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3,…
#&gt; $ carrier        &lt;chr&gt; &quot;UA&quot;, &quot;UA&quot;, &quot;AA&quot;, &quot;B6&quot;, &quot;DL&quot;, &quot;UA&quot;, &quot;B6&quot;, &quot;EV&quot;, &quot;…
#&gt; $ flight         &lt;int&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, …
#&gt; $ tailnum        &lt;chr&gt; &quot;N14228&quot;, &quot;N24211&quot;, &quot;N619AA&quot;, &quot;N804JB&quot;, &quot;N668DN&quot;,…
#&gt; $ origin         &lt;chr&gt; &quot;EWR&quot;, &quot;LGA&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;LGA&quot;, &quot;EWR&quot;, &quot;EWR&quot;, …
#&gt; $ dest           &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;MIA&quot;, &quot;BQN&quot;, &quot;ATL&quot;, &quot;ORD&quot;, &quot;FLL&quot;, …
#&gt; $ air_time       &lt;dbl&gt; 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, …
#&gt; $ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944,…
#&gt; $ hour           &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6…
#&gt; $ minute         &lt;dbl&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
#&gt; $ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-0…

flights2 &lt;- flights %&gt;% 
  select(-year) %&gt;% 
  drop_na()</code></pre>
<p>Any NAs?</p>
<pre class="r"><code>anyNA(flights2)
#&gt; [1] FALSE</code></pre>
</div>
<div id="define-computation-load" class="section level1">
<h1>Define computation load</h1>
<p>Let’s run with some different sample size to gauge the performance.</p>
<p>Define the grid for the computation load, ie., sample size and number of predictors:</p>
<pre class="r"><code>sample_size &lt;- c(100, 500, 1000, 5000, 1e04, 2*1e04, 1e05)

k &lt;- c(1, 2, 5, 10)</code></pre>
</div>
<div id="discard-outcome-vars" class="section level1">
<h1>Discard outcome vars</h1>
<p>We do not want to draw the outcome variabls as predictors, hence we exclude them:</p>
<pre class="r"><code>outcome_vars &lt;- c(&quot;dep_delay&quot;, &quot;arr_delay&quot;)

pred_names &lt;- names(flights2)[!(names(flights2) %in% outcome_vars)]
pred_names
#&gt;  [1] &quot;month&quot;          &quot;day&quot;            &quot;dep_time&quot;       &quot;sched_dep_time&quot;
#&gt;  [5] &quot;arr_time&quot;       &quot;sched_arr_time&quot; &quot;carrier&quot;        &quot;flight&quot;        
#&gt;  [9] &quot;tailnum&quot;        &quot;origin&quot;         &quot;dest&quot;           &quot;air_time&quot;      
#&gt; [13] &quot;distance&quot;       &quot;hour&quot;           &quot;minute&quot;         &quot;time_hour&quot;

str(pred_names)
#&gt;  chr [1:16] &quot;month&quot; &quot;day&quot; &quot;dep_time&quot; &quot;sched_dep_time&quot; &quot;arr_time&quot; ...
pred_names[outcome_vars]
#&gt; [1] NA NA
names(flights2)[outcome_vars]
#&gt; [1] NA NA</code></pre>
<p>Discarding using <code>purrr</code>:</p>
<pre class="r"><code>
dummy &lt;- str_detect(names(flights2), &quot;_delay&quot;) %&gt;% discard(.x = names(flights2), .p = .)
dummy
#&gt;  [1] &quot;month&quot;          &quot;day&quot;            &quot;dep_time&quot;       &quot;sched_dep_time&quot;
#&gt;  [5] &quot;arr_time&quot;       &quot;sched_arr_time&quot; &quot;carrier&quot;        &quot;flight&quot;        
#&gt;  [9] &quot;tailnum&quot;        &quot;origin&quot;         &quot;dest&quot;           &quot;air_time&quot;      
#&gt; [13] &quot;distance&quot;       &quot;hour&quot;           &quot;minute&quot;         &quot;time_hour&quot;

str(dummy)
#&gt;  chr [1:16] &quot;month&quot; &quot;day&quot; &quot;dep_time&quot; &quot;sched_dep_time&quot; &quot;arr_time&quot; ...
names(flights2)[outcome_vars]
#&gt; [1] NA NA</code></pre>
<p>Define index numbers of predictors:</p>
<pre class="r"><code>set.seed(42)
pred_positions &lt;- sample(x = 1:length(pred_names), size = 3)
pred_positions
#&gt; [1]  1  5 16

pred_names &lt;- pred_names[pred_positions]
pred_names
#&gt; [1] &quot;month&quot;     &quot;arr_time&quot;  &quot;time_hour&quot;</code></pre>
<p>And now we draw the desired number of preditors:</p>
<pre class="r"><code>flights_k &lt;- select(flights, one_of(pred_names))</code></pre>
<p>Put that into a function, and wait: some categorical columns are a pain. Consider <code>dest</code> with many levels. Let’s put in a lever to include ony numerical columns.</p>
<pre class="r"><code>draw_preds_flights &lt;- function(df = flights2, k, numeric_only = TRUE) {
  
  
  if (numeric_only == TRUE) {
    df &lt;- df %&gt;% select_if(is.numeric)
  }

  pred_names &lt;- str_detect(names(df), &quot;_delay&quot;) %&gt;% discard(.x = names(df), .p = .)
  
  
  pred_positions &lt;- sample(x = 1:length(pred_names), size = k)
  
  pred_names_selected &lt;- pred_names[pred_positions]

  flights_k &lt;- select(df, one_of(pred_names_selected))

  return(flights_k)
}</code></pre>
<p>Test the function:</p>
<pre class="r"><code>draw_preds_flights(k = 7) %&gt;% str()
#&gt; Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    327346 obs. of  7 variables:
#&gt;  $ distance      : num  1400 1416 1089 1576 762 ...
#&gt;  $ hour          : num  5 5 5 5 6 5 6 6 6 6 ...
#&gt;  $ sched_dep_time: int  515 529 540 545 600 558 600 600 600 600 ...
#&gt;  $ day           : int  1 1 1 1 1 1 1 1 1 1 ...
#&gt;  $ air_time      : num  227 227 160 183 116 150 158 53 140 138 ...
#&gt;  $ month         : int  1 1 1 1 1 1 1 1 1 1 ...
#&gt;  $ minute        : num  15 29 40 45 0 58 0 0 0 0 ...</code></pre>
<p>Appears to work.</p>
<p>Here’s a cross val scheme:</p>
<pre class="r"><code>my_crossval &lt;- trainControl(method = &quot;cv&quot;,
                            number = 5,
                            allowParallel = TRUE)</code></pre>
<p>Here’s a scheme to turn it off:</p>
<pre class="r"><code>no_crossval &lt;- trainControl(method = &quot;none&quot;)</code></pre>
<p>Now craft a function that performs a lm fit using caret given the compution load.</p>
<pre class="r"><code>
lm_flights &lt;- function(df = flights2, n, n_preds, crossval = my_crossval) {
  
  df &lt;- draw_preds_flights(df = df, k = n_preds)
  
  # add outcome var:
  df &lt;- df %&gt;% 
    bind_cols(flights2 %&gt;% select(arr_delay))
  
  df &lt;- sample_n(df, size = n)
  
  lm_fit1 &lt;- train(arr_delay ~ .,
                 data = df,
                 method = &quot;lm&quot;,
                 trControl = my_crossval) 
  
  return(lm_fit1)
}</code></pre>
<p>Test the function.</p>
<pre class="r"><code>start &lt;- Sys.time()
dummy &lt;- lm_flights(n = 200, n_preds = 3)
end &lt;- Sys.time()

time_taken &lt;- end - start
cat(&quot;Time taken: &quot;, time_taken)
#&gt; Time taken:  0.5061591</code></pre>
<pre class="r"><code>start &lt;- Sys.time()
dummy &lt;- lm_flights(n = 1000, n_preds = 3)
end &lt;- Sys.time()

time_taken &lt;- end - start
cat(&quot;Time taken: &quot;, time_taken)
#&gt; Time taken:  0.8717802</code></pre>
<pre class="r"><code>start &lt;- Sys.time()
dummy &lt;- lm_flights(n = 1e5, n_preds = 3)
end &lt;- Sys.time()

time_taken &lt;- end - start
cat(&quot;Time taken: &quot;, time_taken)
#&gt; Time taken:  2.815394</code></pre>
<p>Register cores:</p>
<pre class="r"><code>doMC::registerDoMC(cores = 2)</code></pre>
<p>Now with more cores:</p>
<pre class="r"><code>start &lt;- Sys.time()
dummy &lt;- lm_flights(n = 200, n_preds = 3)
end &lt;- Sys.time()

time_taken &lt;- end - start
cat(&quot;Time taken: &quot;, time_taken)
#&gt; Time taken:  0.565805</code></pre>
<p>Half the time!</p>
<pre class="r"><code>start &lt;- Sys.time()
dummy &lt;- lm_flights(n = 200, n_preds = 3, crossval = no_crossval)
end &lt;- Sys.time()

time_taken &lt;- end - start
cat(&quot;Time taken: &quot;, time_taken)
#&gt; Time taken:  0.5536761

summary(dummy)
#&gt; 
#&gt; Call:
#&gt; lm(formula = .outcome ~ ., data = dat)
#&gt; 
#&gt; Residuals:
#&gt;    Min     1Q Median     3Q    Max 
#&gt; -61.39 -22.68 -10.33  11.97 233.35 
#&gt; 
#&gt; Coefficients:
#&gt;              Estimate Std. Error t value Pr(&gt;|t|)   
#&gt; (Intercept) -11.98724   10.39743  -1.153  0.25035   
#&gt; minute       -0.03708    0.16008  -0.232  0.81706   
#&gt; air_time     -0.02181    0.03611  -0.604  0.54662   
#&gt; hour          1.79362    0.64672   2.773  0.00608 **
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; Residual standard error: 42.72 on 196 degrees of freedom
#&gt; Multiple R-squared:  0.0383, Adjusted R-squared:  0.02358 
#&gt; F-statistic: 2.602 on 3 and 196 DF,  p-value: 0.05326</code></pre>
<p>Define function that just gives back the time taken:</p>
<pre class="r"><code>lm_flights_duration &lt;- function(df = flights2, n, k, crossval = my_crossval) {
  start &lt;- Sys.time()
  dummy &lt;- lm_flights(df = df, n = n, n_preds = k, crossval = crossval)
  end &lt;- Sys.time()
  
  rm(dummy)

  time_taken &lt;- end - start
  return(time_taken)
}</code></pre>
<p>Test it:</p>
<pre class="r"><code>lm_flights_duration(n = 200, k = 3)
#&gt; Time difference of 0.537606 secs
lm_flights_duration(n = 1000, k = 3)
#&gt; Time difference of 0.5362749 secs
lm_flights_duration(n = 1e5, k = 3)
#&gt; Time difference of 2.059408 secs</code></pre>
<p>Low put that into a loop:</p>
<pre class="r"><code>time_df &lt;- tibble(n = NA,
                  k = NA,
                  time_taken = NA,
                  trial = NA,
                  run = NA)

i &lt;- 1
j &lt;- 1
trial &lt;- 1

max_trial &lt;- 10

run &lt;- 1


for (i in seq_along(sample_size)) {  # loop for sample size
  cat(&quot;n = &quot;, sample_size[i], &quot;\n&quot;)
  
  for (j in seq_along(k)) {  # loop for number of predictors (k)
    cat(&quot;  k = &quot;, k[j], &quot;\n&quot;)
    
    for (trial in 1:max_trial) {
      cat(&quot;    trial = &quot;, trial, &quot;\n&quot;)
      cat(&quot;    run = &quot;, run, &quot;\n&quot;)
      
      lm_duration &lt;- lm_flights_duration(n = sample_size[i], k = k[j])
      cat(&quot;Time taken for present model computation: &quot;, lm_duration, &quot; s \n&quot;)
    
      time_df &lt;- time_df %&gt;% 
        add_row(n = sample_size[i],
                k = k[j],
                trial = trial,
                time_taken = lm_duration,
                run = run)
      
      run &lt;- run + 1
    }
  }
}
#&gt; n =  100 
#&gt;   k =  1 
#&gt;     trial =  1 
#&gt;     run =  1 
#&gt; Time taken for present model computation:  1.081863  s 
#&gt;     trial =  2 
#&gt;     run =  2 
#&gt; Time taken for present model computation:  0.4767709  s 
#&gt;     trial =  3 
#&gt;     run =  3 
#&gt; Time taken for present model computation:  0.4721088  s 
#&gt;     trial =  4 
#&gt;     run =  4 
#&gt; Time taken for present model computation:  0.438689  s 
#&gt;     trial =  5 
#&gt;     run =  5 
#&gt; Time taken for present model computation:  0.4379151  s 
#&gt;     trial =  6 
#&gt;     run =  6 
#&gt; Time taken for present model computation:  0.4470088  s 
#&gt;     trial =  7 
#&gt;     run =  7 
#&gt; Time taken for present model computation:  0.437305  s 
#&gt;     trial =  8 
#&gt;     run =  8 
#&gt; Time taken for present model computation:  0.437597  s 
#&gt;     trial =  9 
#&gt;     run =  9 
#&gt; Time taken for present model computation:  0.437248  s 
#&gt;     trial =  10 
#&gt;     run =  10 
#&gt; Time taken for present model computation:  0.435257  s 
#&gt;   k =  2 
#&gt;     trial =  1 
#&gt;     run =  11 
#&gt; Time taken for present model computation:  0.4330289  s 
#&gt;     trial =  2 
#&gt;     run =  12 
#&gt; Time taken for present model computation:  0.443146  s 
#&gt;     trial =  3 
#&gt;     run =  13 
#&gt; Time taken for present model computation:  0.4344649  s 
#&gt;     trial =  4 
#&gt;     run =  14 
#&gt; Time taken for present model computation:  0.437479  s 
#&gt;     trial =  5 
#&gt;     run =  15 
#&gt; Time taken for present model computation:  0.440253  s 
#&gt;     trial =  6 
#&gt;     run =  16 
#&gt; Time taken for present model computation:  0.4336469  s 
#&gt;     trial =  7 
#&gt;     run =  17 
#&gt; Time taken for present model computation:  0.444977  s 
#&gt;     trial =  8 
#&gt;     run =  18 
#&gt; Time taken for present model computation:  0.4379861  s 
#&gt;     trial =  9 
#&gt;     run =  19 
#&gt; Time taken for present model computation:  0.4363792  s 
#&gt;     trial =  10 
#&gt;     run =  20 
#&gt; Time taken for present model computation:  0.5396779  s 
#&gt;   k =  5 
#&gt;     trial =  1 
#&gt;     run =  21 
#&gt; Time taken for present model computation:  0.4446821  s 
#&gt;     trial =  2 
#&gt;     run =  22 
#&gt; Time taken for present model computation:  0.441684  s 
#&gt;     trial =  3 
#&gt;     run =  23 
#&gt; Time taken for present model computation:  0.4409502  s 
#&gt;     trial =  4 
#&gt;     run =  24 
#&gt; Time taken for present model computation:  0.5154259  s 
#&gt;     trial =  5 
#&gt;     run =  25 
#&gt; Time taken for present model computation:  0.439065  s 
#&gt;     trial =  6 
#&gt;     run =  26 
#&gt; Time taken for present model computation:  0.4437191  s 
#&gt;     trial =  7 
#&gt;     run =  27 
#&gt; Time taken for present model computation:  0.4360859  s 
#&gt;     trial =  8 
#&gt;     run =  28 
#&gt; Time taken for present model computation:  0.445807  s 
#&gt;     trial =  9 
#&gt;     run =  29 
#&gt; Time taken for present model computation:  0.4463658  s 
#&gt;     trial =  10 
#&gt;     run =  30 
#&gt; Time taken for present model computation:  0.4561081  s 
#&gt;   k =  10 
#&gt;     trial =  1 
#&gt;     run =  31 
#&gt; Time taken for present model computation:  0.4590909  s 
#&gt;     trial =  2 
#&gt;     run =  32 
#&gt; Time taken for present model computation:  0.445292  s 
#&gt;     trial =  3 
#&gt;     run =  33 
#&gt; Time taken for present model computation:  0.439853  s 
#&gt;     trial =  4 
#&gt;     run =  34 
#&gt; Time taken for present model computation:  0.4462152  s 
#&gt;     trial =  5 
#&gt;     run =  35 
#&gt; Time taken for present model computation:  0.444721  s 
#&gt;     trial =  6 
#&gt;     run =  36 
#&gt; Time taken for present model computation:  0.4642301  s 
#&gt;     trial =  7 
#&gt;     run =  37 
#&gt; Time taken for present model computation:  0.44784  s 
#&gt;     trial =  8 
#&gt;     run =  38 
#&gt; Time taken for present model computation:  0.443491  s 
#&gt;     trial =  9 
#&gt;     run =  39 
#&gt; Time taken for present model computation:  0.448123  s 
#&gt;     trial =  10 
#&gt;     run =  40 
#&gt; Time taken for present model computation:  0.4442511  s 
#&gt; n =  500 
#&gt;   k =  1 
#&gt;     trial =  1 
#&gt;     run =  41 
#&gt; Time taken for present model computation:  0.4442301  s 
#&gt;     trial =  2 
#&gt;     run =  42 
#&gt; Time taken for present model computation:  0.5318801  s 
#&gt;     trial =  3 
#&gt;     run =  43 
#&gt; Time taken for present model computation:  0.5844562  s 
#&gt;     trial =  4 
#&gt;     run =  44 
#&gt; Time taken for present model computation:  0.4407461  s 
#&gt;     trial =  5 
#&gt;     run =  45 
#&gt; Time taken for present model computation:  0.4416189  s 
#&gt;     trial =  6 
#&gt;     run =  46 
#&gt; Time taken for present model computation:  0.4451249  s 
#&gt;     trial =  7 
#&gt;     run =  47 
#&gt; Time taken for present model computation:  0.4442358  s 
#&gt;     trial =  8 
#&gt;     run =  48 
#&gt; Time taken for present model computation:  0.4367981  s 
#&gt;     trial =  9 
#&gt;     run =  49 
#&gt; Time taken for present model computation:  0.4361279  s 
#&gt;     trial =  10 
#&gt;     run =  50 
#&gt; Time taken for present model computation:  0.4720929  s 
#&gt;   k =  2 
#&gt;     trial =  1 
#&gt;     run =  51 
#&gt; Time taken for present model computation:  0.5250502  s 
#&gt;     trial =  2 
#&gt;     run =  52 
#&gt; Time taken for present model computation:  0.441947  s 
#&gt;     trial =  3 
#&gt;     run =  53 
#&gt; Time taken for present model computation:  0.4436438  s 
#&gt;     trial =  4 
#&gt;     run =  54 
#&gt; Time taken for present model computation:  0.4400389  s 
#&gt;     trial =  5 
#&gt;     run =  55 
#&gt; Time taken for present model computation:  0.6254661  s 
#&gt;     trial =  6 
#&gt;     run =  56 
#&gt; Time taken for present model computation:  0.4434049  s 
#&gt;     trial =  7 
#&gt;     run =  57 
#&gt; Time taken for present model computation:  0.442023  s 
#&gt;     trial =  8 
#&gt;     run =  58 
#&gt; Time taken for present model computation:  0.444391  s 
#&gt;     trial =  9 
#&gt;     run =  59 
#&gt; Time taken for present model computation:  0.447026  s 
#&gt;     trial =  10 
#&gt;     run =  60 
#&gt; Time taken for present model computation:  0.446955  s 
#&gt;   k =  5 
#&gt;     trial =  1 
#&gt;     run =  61 
#&gt; Time taken for present model computation:  0.4426479  s 
#&gt;     trial =  2 
#&gt;     run =  62 
#&gt; Time taken for present model computation:  0.6556299  s 
#&gt;     trial =  3 
#&gt;     run =  63 
#&gt; Time taken for present model computation:  0.631006  s 
#&gt;     trial =  4 
#&gt;     run =  64 
#&gt; Time taken for present model computation:  0.6135962  s 
#&gt;     trial =  5 
#&gt;     run =  65 
#&gt; Time taken for present model computation:  0.6482961  s 
#&gt;     trial =  6 
#&gt;     run =  66 
#&gt; Time taken for present model computation:  0.443377  s 
#&gt;     trial =  7 
#&gt;     run =  67 
#&gt; Time taken for present model computation:  0.4554012  s 
#&gt;     trial =  8 
#&gt;     run =  68 
#&gt; Time taken for present model computation:  0.4599311  s 
#&gt;     trial =  9 
#&gt;     run =  69 
#&gt; Time taken for present model computation:  0.455996  s 
#&gt;     trial =  10 
#&gt;     run =  70 
#&gt; Time taken for present model computation:  0.4931841  s 
#&gt;   k =  10 
#&gt;     trial =  1 
#&gt;     run =  71 
#&gt; Time taken for present model computation:  0.4936209  s 
#&gt;     trial =  2 
#&gt;     run =  72 
#&gt; Time taken for present model computation:  0.497539  s 
#&gt;     trial =  3 
#&gt;     run =  73 
#&gt; Time taken for present model computation:  0.8787749  s 
#&gt;     trial =  4 
#&gt;     run =  74 
#&gt; Time taken for present model computation:  0.809119  s 
#&gt;     trial =  5 
#&gt;     run =  75 
#&gt; Time taken for present model computation:  0.5426331  s 
#&gt;     trial =  6 
#&gt;     run =  76 
#&gt; Time taken for present model computation:  0.464215  s 
#&gt;     trial =  7 
#&gt;     run =  77 
#&gt; Time taken for present model computation:  0.5386751  s 
#&gt;     trial =  8 
#&gt;     run =  78 
#&gt; Time taken for present model computation:  0.453577  s 
#&gt;     trial =  9 
#&gt;     run =  79 
#&gt; Time taken for present model computation:  0.4623952  s 
#&gt;     trial =  10 
#&gt;     run =  80 
#&gt; Time taken for present model computation:  0.4489491  s 
#&gt; n =  1000 
#&gt;   k =  1 
#&gt;     trial =  1 
#&gt;     run =  81 
#&gt; Time taken for present model computation:  0.4592569  s 
#&gt;     trial =  2 
#&gt;     run =  82 
#&gt; Time taken for present model computation:  0.4496381  s 
#&gt;     trial =  3 
#&gt;     run =  83 
#&gt; Time taken for present model computation:  0.451736  s 
#&gt;     trial =  4 
#&gt;     run =  84 
#&gt; Time taken for present model computation:  0.4546001  s 
#&gt;     trial =  5 
#&gt;     run =  85 
#&gt; Time taken for present model computation:  0.4720671  s 
#&gt;     trial =  6 
#&gt;     run =  86 
#&gt; Time taken for present model computation:  0.446197  s 
#&gt;     trial =  7 
#&gt;     run =  87 
#&gt; Time taken for present model computation:  0.463027  s 
#&gt;     trial =  8 
#&gt;     run =  88 
#&gt; Time taken for present model computation:  0.4518969  s 
#&gt;     trial =  9 
#&gt;     run =  89 
#&gt; Time taken for present model computation:  0.449012  s 
#&gt;     trial =  10 
#&gt;     run =  90 
#&gt; Time taken for present model computation:  0.4623961  s 
#&gt;   k =  2 
#&gt;     trial =  1 
#&gt;     run =  91 
#&gt; Time taken for present model computation:  0.4603031  s 
#&gt;     trial =  2 
#&gt;     run =  92 
#&gt; Time taken for present model computation:  0.457056  s 
#&gt;     trial =  3 
#&gt;     run =  93 
#&gt; Time taken for present model computation:  0.4493222  s 
#&gt;     trial =  4 
#&gt;     run =  94 
#&gt; Time taken for present model computation:  0.4531391  s 
#&gt;     trial =  5 
#&gt;     run =  95 
#&gt; Time taken for present model computation:  0.450547  s 
#&gt;     trial =  6 
#&gt;     run =  96 
#&gt; Time taken for present model computation:  0.472997  s 
#&gt;     trial =  7 
#&gt;     run =  97 
#&gt; Time taken for present model computation:  0.5127561  s 
#&gt;     trial =  8 
#&gt;     run =  98 
#&gt; Time taken for present model computation:  0.4521949  s 
#&gt;     trial =  9 
#&gt;     run =  99 
#&gt; Time taken for present model computation:  0.593178  s 
#&gt;     trial =  10 
#&gt;     run =  100 
#&gt; Time taken for present model computation:  0.5076699  s 
#&gt;   k =  5 
#&gt;     trial =  1 
#&gt;     run =  101 
#&gt; Time taken for present model computation:  0.4637768  s 
#&gt;     trial =  2 
#&gt;     run =  102 
#&gt; Time taken for present model computation:  0.471168  s 
#&gt;     trial =  3 
#&gt;     run =  103 
#&gt; Time taken for present model computation:  0.487745  s 
#&gt;     trial =  4 
#&gt;     run =  104 
#&gt; Time taken for present model computation:  0.592675  s 
#&gt;     trial =  5 
#&gt;     run =  105 
#&gt; Time taken for present model computation:  0.5066102  s 
#&gt;     trial =  6 
#&gt;     run =  106 
#&gt; Time taken for present model computation:  0.585495  s 
#&gt;     trial =  7 
#&gt;     run =  107 
#&gt; Time taken for present model computation:  0.4994502  s 
#&gt;     trial =  8 
#&gt;     run =  108 
#&gt; Time taken for present model computation:  0.539782  s 
#&gt;     trial =  9 
#&gt;     run =  109 
#&gt; Time taken for present model computation:  0.49896  s 
#&gt;     trial =  10 
#&gt;     run =  110 
#&gt; Time taken for present model computation:  0.4953618  s 
#&gt;   k =  10 
#&gt;     trial =  1 
#&gt;     run =  111 
#&gt; Time taken for present model computation:  0.5023279  s 
#&gt;     trial =  2 
#&gt;     run =  112 
#&gt; Time taken for present model computation:  0.5025802  s 
#&gt;     trial =  3 
#&gt;     run =  113 
#&gt; Time taken for present model computation:  0.509032  s 
#&gt;     trial =  4 
#&gt;     run =  114 
#&gt; Time taken for present model computation:  0.4841821  s 
#&gt;     trial =  5 
#&gt;     run =  115 
#&gt; Time taken for present model computation:  0.498765  s 
#&gt;     trial =  6 
#&gt;     run =  116 
#&gt; Time taken for present model computation:  0.4866431  s 
#&gt;     trial =  7 
#&gt;     run =  117 
#&gt; Time taken for present model computation:  0.499033  s 
#&gt;     trial =  8 
#&gt;     run =  118 
#&gt; Time taken for present model computation:  0.5038011  s 
#&gt;     trial =  9 
#&gt;     run =  119 
#&gt; Time taken for present model computation:  0.5065711  s 
#&gt;     trial =  10 
#&gt;     run =  120 
#&gt; Time taken for present model computation:  0.4977269  s 
#&gt; n =  5000 
#&gt;   k =  1 
#&gt;     trial =  1 
#&gt;     run =  121 
#&gt; Time taken for present model computation:  0.5383601  s 
#&gt;     trial =  2 
#&gt;     run =  122 
#&gt; Time taken for present model computation:  0.5369561  s 
#&gt;     trial =  3 
#&gt;     run =  123 
#&gt; Time taken for present model computation:  0.5346379  s 
#&gt;     trial =  4 
#&gt;     run =  124 
#&gt; Time taken for present model computation:  0.5241148  s 
#&gt;     trial =  5 
#&gt;     run =  125 
#&gt; Time taken for present model computation:  0.5374188  s 
#&gt;     trial =  6 
#&gt;     run =  126 
#&gt; Time taken for present model computation:  0.5398779  s 
#&gt;     trial =  7 
#&gt;     run =  127 
#&gt; Time taken for present model computation:  0.573046  s 
#&gt;     trial =  8 
#&gt;     run =  128 
#&gt; Time taken for present model computation:  0.5561271  s 
#&gt;     trial =  9 
#&gt;     run =  129 
#&gt; Time taken for present model computation:  0.7098169  s 
#&gt;     trial =  10 
#&gt;     run =  130 
#&gt; Time taken for present model computation:  0.6438732  s 
#&gt;   k =  2 
#&gt;     trial =  1 
#&gt;     run =  131 
#&gt; Time taken for present model computation:  0.5494349  s 
#&gt;     trial =  2 
#&gt;     run =  132 
#&gt; Time taken for present model computation:  0.5612428  s 
#&gt;     trial =  3 
#&gt;     run =  133 
#&gt; Time taken for present model computation:  0.536979  s 
#&gt;     trial =  4 
#&gt;     run =  134 
#&gt; Time taken for present model computation:  0.5327849  s 
#&gt;     trial =  5 
#&gt;     run =  135 
#&gt; Time taken for present model computation:  0.5426998  s 
#&gt;     trial =  6 
#&gt;     run =  136 
#&gt; Time taken for present model computation:  0.5875919  s 
#&gt;     trial =  7 
#&gt;     run =  137 
#&gt; Time taken for present model computation:  0.5822392  s 
#&gt;     trial =  8 
#&gt;     run =  138 
#&gt; Time taken for present model computation:  0.7569931  s 
#&gt;     trial =  9 
#&gt;     run =  139 
#&gt; Time taken for present model computation:  0.5909822  s 
#&gt;     trial =  10 
#&gt;     run =  140 
#&gt; Time taken for present model computation:  0.6130528  s 
#&gt;   k =  5 
#&gt;     trial =  1 
#&gt;     run =  141 
#&gt; Time taken for present model computation:  0.5605171  s 
#&gt;     trial =  2 
#&gt;     run =  142 
#&gt; Time taken for present model computation:  0.66048  s 
#&gt;     trial =  3 
#&gt;     run =  143 
#&gt; Time taken for present model computation:  0.8047049  s 
#&gt;     trial =  4 
#&gt;     run =  144 
#&gt; Time taken for present model computation:  0.6085701  s 
#&gt;     trial =  5 
#&gt;     run =  145 
#&gt; Time taken for present model computation:  0.7481561  s 
#&gt;     trial =  6 
#&gt;     run =  146 
#&gt; Time taken for present model computation:  0.8513651  s 
#&gt;     trial =  7 
#&gt;     run =  147 
#&gt; Time taken for present model computation:  1.098596  s 
#&gt;     trial =  8 
#&gt;     run =  148 
#&gt; Time taken for present model computation:  0.7258921  s 
#&gt;     trial =  9 
#&gt;     run =  149 
#&gt; Time taken for present model computation:  0.823082  s 
#&gt;     trial =  10 
#&gt;     run =  150 
#&gt; Time taken for present model computation:  0.5915329  s 
#&gt;   k =  10 
#&gt;     trial =  1 
#&gt;     run =  151 
#&gt; Time taken for present model computation:  0.6477251  s 
#&gt;     trial =  2 
#&gt;     run =  152 
#&gt; Time taken for present model computation:  0.628072  s 
#&gt;     trial =  3 
#&gt;     run =  153 
#&gt; Time taken for present model computation:  0.6369081  s 
#&gt;     trial =  4 
#&gt;     run =  154 
#&gt; Time taken for present model computation:  0.5999858  s 
#&gt;     trial =  5 
#&gt;     run =  155 
#&gt; Time taken for present model computation:  0.6012709  s 
#&gt;     trial =  6 
#&gt;     run =  156 
#&gt; Time taken for present model computation:  0.579746  s 
#&gt;     trial =  7 
#&gt;     run =  157 
#&gt; Time taken for present model computation:  0.610817  s 
#&gt;     trial =  8 
#&gt;     run =  158 
#&gt; Time taken for present model computation:  0.9687049  s 
#&gt;     trial =  9 
#&gt;     run =  159 
#&gt; Time taken for present model computation:  1.114943  s 
#&gt;     trial =  10 
#&gt;     run =  160 
#&gt; Time taken for present model computation:  0.820246  s 
#&gt; n =  10000 
#&gt;   k =  1 
#&gt;     trial =  1 
#&gt;     run =  161 
#&gt; Time taken for present model computation:  0.9626641  s 
#&gt;     trial =  2 
#&gt;     run =  162 
#&gt; Time taken for present model computation:  0.9527571  s 
#&gt;     trial =  3 
#&gt;     run =  163 
#&gt; Time taken for present model computation:  0.8696439  s 
#&gt;     trial =  4 
#&gt;     run =  164 
#&gt; Time taken for present model computation:  0.7900901  s 
#&gt;     trial =  5 
#&gt;     run =  165 
#&gt; Time taken for present model computation:  0.6508131  s 
#&gt;     trial =  6 
#&gt;     run =  166 
#&gt; Time taken for present model computation:  0.9293659  s 
#&gt;     trial =  7 
#&gt;     run =  167 
#&gt; Time taken for present model computation:  0.8383338  s 
#&gt;     trial =  8 
#&gt;     run =  168 
#&gt; Time taken for present model computation:  0.6500361  s 
#&gt;     trial =  9 
#&gt;     run =  169 
#&gt; Time taken for present model computation:  0.7106299  s 
#&gt;     trial =  10 
#&gt;     run =  170 
#&gt; Time taken for present model computation:  1.070245  s 
#&gt;   k =  2 
#&gt;     trial =  1 
#&gt;     run =  171 
#&gt; Time taken for present model computation:  0.7441781  s 
#&gt;     trial =  2 
#&gt;     run =  172 
#&gt; Time taken for present model computation:  0.6520219  s 
#&gt;     trial =  3 
#&gt;     run =  173 
#&gt; Time taken for present model computation:  0.664592  s 
#&gt;     trial =  4 
#&gt;     run =  174 
#&gt; Time taken for present model computation:  0.7777629  s 
#&gt;     trial =  5 
#&gt;     run =  175 
#&gt; Time taken for present model computation:  0.6470389  s 
#&gt;     trial =  6 
#&gt;     run =  176 
#&gt; Time taken for present model computation:  0.6708791  s 
#&gt;     trial =  7 
#&gt;     run =  177 
#&gt; Time taken for present model computation:  0.774122  s 
#&gt;     trial =  8 
#&gt;     run =  178 
#&gt; Time taken for present model computation:  1.122771  s 
#&gt;     trial =  9 
#&gt;     run =  179 
#&gt; Time taken for present model computation:  0.8425469  s 
#&gt;     trial =  10 
#&gt;     run =  180 
#&gt; Time taken for present model computation:  0.723881  s 
#&gt;   k =  5 
#&gt;     trial =  1 
#&gt;     run =  181 
#&gt; Time taken for present model computation:  0.8225582  s 
#&gt;     trial =  2 
#&gt;     run =  182 
#&gt; Time taken for present model computation:  1.084098  s 
#&gt;     trial =  3 
#&gt;     run =  183 
#&gt; Time taken for present model computation:  0.7142301  s 
#&gt;     trial =  4 
#&gt;     run =  184 
#&gt; Time taken for present model computation:  0.987601  s 
#&gt;     trial =  5 
#&gt;     run =  185 
#&gt; Time taken for present model computation:  1.043293  s 
#&gt;     trial =  6 
#&gt;     run =  186 
#&gt; Time taken for present model computation:  1.091965  s 
#&gt;     trial =  7 
#&gt;     run =  187 
#&gt; Time taken for present model computation:  0.963506  s 
#&gt;     trial =  8 
#&gt;     run =  188 
#&gt; Time taken for present model computation:  1.372548  s 
#&gt;     trial =  9 
#&gt;     run =  189 
#&gt; Time taken for present model computation:  1.107177  s 
#&gt;     trial =  10 
#&gt;     run =  190 
#&gt; Time taken for present model computation:  0.9992149  s 
#&gt;   k =  10 
#&gt;     trial =  1 
#&gt;     run =  191 
#&gt; Time taken for present model computation:  1.086515  s 
#&gt;     trial =  2 
#&gt;     run =  192 
#&gt; Time taken for present model computation:  0.8890159  s 
#&gt;     trial =  3 
#&gt;     run =  193 
#&gt; Time taken for present model computation:  1.135766  s 
#&gt;     trial =  4 
#&gt;     run =  194 
#&gt; Time taken for present model computation:  0.770365  s 
#&gt;     trial =  5 
#&gt;     run =  195 
#&gt; Time taken for present model computation:  1.076935  s 
#&gt;     trial =  6 
#&gt;     run =  196 
#&gt; Time taken for present model computation:  0.784188  s 
#&gt;     trial =  7 
#&gt;     run =  197 
#&gt; Time taken for present model computation:  1.018505  s 
#&gt;     trial =  8 
#&gt;     run =  198 
#&gt; Time taken for present model computation:  1.161256  s 
#&gt;     trial =  9 
#&gt;     run =  199 
#&gt; Time taken for present model computation:  1.088395  s 
#&gt;     trial =  10 
#&gt;     run =  200 
#&gt; Time taken for present model computation:  1.568357  s 
#&gt; n =  20000 
#&gt;   k =  1 
#&gt;     trial =  1 
#&gt;     run =  201 
#&gt; Time taken for present model computation:  1.249474  s 
#&gt;     trial =  2 
#&gt;     run =  202 
#&gt; Time taken for present model computation:  1.129212  s 
#&gt;     trial =  3 
#&gt;     run =  203 
#&gt; Time taken for present model computation:  1.116724  s 
#&gt;     trial =  4 
#&gt;     run =  204 
#&gt; Time taken for present model computation:  1.263537  s 
#&gt;     trial =  5 
#&gt;     run =  205 
#&gt; Time taken for present model computation:  1.090505  s 
#&gt;     trial =  6 
#&gt;     run =  206 
#&gt; Time taken for present model computation:  1.047199  s 
#&gt;     trial =  7 
#&gt;     run =  207 
#&gt; Time taken for present model computation:  1.096708  s 
#&gt;     trial =  8 
#&gt;     run =  208 
#&gt; Time taken for present model computation:  1.192962  s 
#&gt;     trial =  9 
#&gt;     run =  209 
#&gt; Time taken for present model computation:  1.170878  s 
#&gt;     trial =  10 
#&gt;     run =  210 
#&gt; Time taken for present model computation:  1.300999  s 
#&gt;   k =  2 
#&gt;     trial =  1 
#&gt;     run =  211 
#&gt; Time taken for present model computation:  1.056511  s 
#&gt;     trial =  2 
#&gt;     run =  212 
#&gt; Time taken for present model computation:  1.19051  s 
#&gt;     trial =  3 
#&gt;     run =  213 
#&gt; Time taken for present model computation:  1.245578  s 
#&gt;     trial =  4 
#&gt;     run =  214 
#&gt; Time taken for present model computation:  1.007171  s 
#&gt;     trial =  5 
#&gt;     run =  215 
#&gt; Time taken for present model computation:  0.9098899  s 
#&gt;     trial =  6 
#&gt;     run =  216 
#&gt; Time taken for present model computation:  1.03809  s 
#&gt;     trial =  7 
#&gt;     run =  217 
#&gt; Time taken for present model computation:  1.060952  s 
#&gt;     trial =  8 
#&gt;     run =  218 
#&gt; Time taken for present model computation:  1.403779  s 
#&gt;     trial =  9 
#&gt;     run =  219 
#&gt; Time taken for present model computation:  1.09942  s 
#&gt;     trial =  10 
#&gt;     run =  220 
#&gt; Time taken for present model computation:  1.27247  s 
#&gt;   k =  5 
#&gt;     trial =  1 
#&gt;     run =  221 
#&gt; Time taken for present model computation:  1.019589  s 
#&gt;     trial =  2 
#&gt;     run =  222 
#&gt; Time taken for present model computation:  1.178619  s 
#&gt;     trial =  3 
#&gt;     run =  223 
#&gt; Time taken for present model computation:  1.08717  s 
#&gt;     trial =  4 
#&gt;     run =  224 
#&gt; Time taken for present model computation:  0.9382942  s 
#&gt;     trial =  5 
#&gt;     run =  225 
#&gt; Time taken for present model computation:  0.8877261  s 
#&gt;     trial =  6 
#&gt;     run =  226 
#&gt; Time taken for present model computation:  0.8789959  s 
#&gt;     trial =  7 
#&gt;     run =  227 
#&gt; Time taken for present model computation:  0.881546  s 
#&gt;     trial =  8 
#&gt;     run =  228 
#&gt; Time taken for present model computation:  0.916564  s 
#&gt;     trial =  9 
#&gt;     run =  229 
#&gt; Time taken for present model computation:  0.8839359  s 
#&gt;     trial =  10 
#&gt;     run =  230 
#&gt; Time taken for present model computation:  0.9359338  s 
#&gt;   k =  10 
#&gt;     trial =  1 
#&gt;     run =  231 
#&gt; Time taken for present model computation:  1.303608  s 
#&gt;     trial =  2 
#&gt;     run =  232 
#&gt; Time taken for present model computation:  1.121285  s 
#&gt;     trial =  3 
#&gt;     run =  233 
#&gt; Time taken for present model computation:  1.179266  s 
#&gt;     trial =  4 
#&gt;     run =  234 
#&gt; Time taken for present model computation:  1.120013  s 
#&gt;     trial =  5 
#&gt;     run =  235 
#&gt; Time taken for present model computation:  1.624908  s 
#&gt;     trial =  6 
#&gt;     run =  236 
#&gt; Time taken for present model computation:  1.045926  s 
#&gt;     trial =  7 
#&gt;     run =  237 
#&gt; Time taken for present model computation:  1.011557  s 
#&gt;     trial =  8 
#&gt;     run =  238 
#&gt; Time taken for present model computation:  0.988035  s 
#&gt;     trial =  9 
#&gt;     run =  239 
#&gt; Time taken for present model computation:  1.648639  s 
#&gt;     trial =  10 
#&gt;     run =  240 
#&gt; Time taken for present model computation:  1.673923  s 
#&gt; n =  1e+05 
#&gt;   k =  1 
#&gt;     trial =  1 
#&gt;     run =  241 
#&gt; Time taken for present model computation:  4.281005  s 
#&gt;     trial =  2 
#&gt;     run =  242 
#&gt; Time taken for present model computation:  4.204582  s 
#&gt;     trial =  3 
#&gt;     run =  243 
#&gt; Time taken for present model computation:  3.944786  s 
#&gt;     trial =  4 
#&gt;     run =  244 
#&gt; Time taken for present model computation:  2.798044  s 
#&gt;     trial =  5 
#&gt;     run =  245 
#&gt; Time taken for present model computation:  2.558156  s 
#&gt;     trial =  6 
#&gt;     run =  246 
#&gt; Time taken for present model computation:  2.953777  s 
#&gt;     trial =  7 
#&gt;     run =  247 
#&gt; Time taken for present model computation:  3.665101  s 
#&gt;     trial =  8 
#&gt;     run =  248 
#&gt; Time taken for present model computation:  3.418542  s 
#&gt;     trial =  9 
#&gt;     run =  249 
#&gt; Time taken for present model computation:  3.354636  s 
#&gt;     trial =  10 
#&gt;     run =  250 
#&gt; Time taken for present model computation:  2.95774  s 
#&gt;   k =  2 
#&gt;     trial =  1 
#&gt;     run =  251 
#&gt; Time taken for present model computation:  3.145113  s 
#&gt;     trial =  2 
#&gt;     run =  252 
#&gt; Time taken for present model computation:  2.544685  s 
#&gt;     trial =  3 
#&gt;     run =  253 
#&gt; Time taken for present model computation:  2.571834  s 
#&gt;     trial =  4 
#&gt;     run =  254 
#&gt; Time taken for present model computation:  2.700399  s 
#&gt;     trial =  5 
#&gt;     run =  255 
#&gt; Time taken for present model computation:  2.548327  s 
#&gt;     trial =  6 
#&gt;     run =  256 
#&gt; Time taken for present model computation:  2.915473  s 
#&gt;     trial =  7 
#&gt;     run =  257 
#&gt; Time taken for present model computation:  2.859279  s 
#&gt;     trial =  8 
#&gt;     run =  258 
#&gt; Time taken for present model computation:  2.73993  s 
#&gt;     trial =  9 
#&gt;     run =  259 
#&gt; Time taken for present model computation:  2.883709  s 
#&gt;     trial =  10 
#&gt;     run =  260 
#&gt; Time taken for present model computation:  2.709883  s 
#&gt;   k =  5 
#&gt;     trial =  1 
#&gt;     run =  261 
#&gt; Time taken for present model computation:  3.273748  s 
#&gt;     trial =  2 
#&gt;     run =  262 
#&gt; Time taken for present model computation:  2.935905  s 
#&gt;     trial =  3 
#&gt;     run =  263 
#&gt; Time taken for present model computation:  2.833582  s 
#&gt;     trial =  4 
#&gt;     run =  264 
#&gt; Time taken for present model computation:  3.734762  s 
#&gt;     trial =  5 
#&gt;     run =  265 
#&gt; Time taken for present model computation:  3.014805  s 
#&gt;     trial =  6 
#&gt;     run =  266 
#&gt; Time taken for present model computation:  3.585858  s 
#&gt;     trial =  7 
#&gt;     run =  267 
#&gt; Time taken for present model computation:  3.106992  s 
#&gt;     trial =  8 
#&gt;     run =  268 
#&gt; Time taken for present model computation:  2.803939  s 
#&gt;     trial =  9 
#&gt;     run =  269 
#&gt; Time taken for present model computation:  2.900499  s 
#&gt;     trial =  10 
#&gt;     run =  270 
#&gt; Time taken for present model computation:  3.422959  s 
#&gt;   k =  10 
#&gt;     trial =  1 
#&gt;     run =  271 
#&gt; Time taken for present model computation:  3.97062  s 
#&gt;     trial =  2 
#&gt;     run =  272 
#&gt; Time taken for present model computation:  4.130229  s 
#&gt;     trial =  3 
#&gt;     run =  273 
#&gt; Time taken for present model computation:  3.900531  s 
#&gt;     trial =  4 
#&gt;     run =  274 
#&gt; Time taken for present model computation:  5.105087  s 
#&gt;     trial =  5 
#&gt;     run =  275 
#&gt; Time taken for present model computation:  5.50513  s 
#&gt;     trial =  6 
#&gt;     run =  276 
#&gt; Time taken for present model computation:  4.338999  s 
#&gt;     trial =  7 
#&gt;     run =  277 
#&gt; Time taken for present model computation:  4.343665  s 
#&gt;     trial =  8 
#&gt;     run =  278 
#&gt; Time taken for present model computation:  4.533405  s 
#&gt;     trial =  9 
#&gt;     run =  279 
#&gt; Time taken for present model computation:  5.312447  s 
#&gt;     trial =  10 
#&gt;     run =  280 
#&gt; Time taken for present model computation:  4.613441  s</code></pre>
</div>
<div id="show-the-results" class="section level1">
<h1>Show the results</h1>
<p>Now let’s put that together.</p>
<pre class="r"><code>time_df &lt;- time_df %&gt;% 
  mutate(id = 1:nrow(time_df)) %&gt;% 
  group_by(k, n) %&gt;% 
  mutate(time_taken_avg = mean(time_taken, na.rm = TRUE)) %&gt;% 
  ungroup()

time_df &lt;- time_df %&gt;% 
  drop_na() </code></pre>
<pre class="r"><code>time_df %&gt;% 
  ggplot(aes(x = n, y = time_taken, color = factor(k))) +
  geom_point() +
  scale_x_log10(breaks = sample_size) +
  geom_line(aes(y = time_taken_avg, group = k)) +
  labs(color = &quot;k&quot;,
       y = &quot;computation time [sec]&quot;) +
  scale_color_viridis_d()  +
  theme_light()</code></pre>
<p><img src="/post/2019-08-02-performance-measures-for-caret-and-lm-r_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For small samples, there’s a large variance in computation time, with sample sizes augmenting, the computation time differences become more stable.</p>
<pre class="r"><code>time_df %&gt;% 
  drop_na() %&gt;% 
  ggplot(aes(x = n, y = time_taken, color = factor(k))) +
  geom_point() +
  scale_x_log10(breaks = c(1e1, 1e03, 1e04, 1e05)) +
  geom_line(aes(y = time_taken_avg, group = k)) +
  facet_wrap(~ k, labeller = label_context) +
  labs(color = &quot;k&quot;) +
  scale_color_viridis_d() +
  theme_light()</code></pre>
<p><img src="/post/2019-08-02-performance-measures-for-caret-and-lm-r_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="debrief" class="section level1">
<h1>Debrief</h1>
<p>On average, the time for each model was acceptable. However, two things should be noted: First, non-numeric variables can consume much more time (if many levels are present). Second, parameter tuning and cross validation will soak up a lot of time. Assume there are 3 tuning parameters, and we test 5 values each (thus yielding 15 models). Assume further we will use a 10 times cross validation with 10 folds each, giving 100 repetitions. In sum, 15k repetitions will be needed. That will take ages, and possible a lot of memory can be exhausted.</p>
</div>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//https-data-se-netlify-com.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

